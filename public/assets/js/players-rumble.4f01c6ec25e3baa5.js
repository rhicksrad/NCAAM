var ea=[];function rr(t,e,r){return t<e?e:t>r?r:t}function ra(t){return Number.isFinite(t)?rr(t,0,1)*100:0}function Gt(t){return Number.isFinite(t)?t>1?rr(t,0,100):rr(t*100,0,100):0}function de(t){return t?Array.from(new Set(t)):[]}function na(t){var h,f;let e=new Set,r=ra(t.threePA_rate),n=Gt(t.threeP),o=Gt(t.usg),i=Gt(t.astPct),a=Gt(t.stl),s=Gt(t.blk),l=t.paceZ,u=t.impact,m=(f=(h=t.pos)==null?void 0:h.toUpperCase())!=null?f:"";return(i>=28||o>=28&&i>=18)&&e.add("Creator"),!e.has("Creator")&&(i>=20||o>=24)&&e.add("Secondary"),r>=45&&n>=36?e.add("Off-ball Shooter"):r>=36&&n>=34&&e.add("Connector"),(m.includes("F")||m.includes("C"))&&l>=.2&&u>=5&&e.add("Switch Big"),(m.includes("C")||m.includes("F"))&&s>=4&&e.add("Rim Protector"),(m.includes("C")||m.includes("F"))&&l>=.3&&u>=3&&e.add("Rim Runner"),n>=35&&r>=30&&i>=12&&o<=24&&e.add("Connector"),a>=3.2&&l>=0&&e.add("POA Stopper"),u>=6&&i>=16&&o<=22&&e.add("Connector"),e.size===0&&u>=8&&e.add("Connector"),Array.from(e)}function oa(t){var s,l;let e=new Set,r=(l=(s=t.pos)==null?void 0:s.toUpperCase())!=null?l:"";if(!r.trim())return[];let n=u=>{e.add(u)},o=r.includes("G"),i=r.includes("C"),a=r.includes("F");return o&&(t.astPct>=22||t.usg>=26?n("Creator"):(t.astPct>=16||t.usg>=22)&&n("Secondary"),n("Connector")),i?(n("Rim Protector"),(t.paceZ>=.2||t.impact>=6)&&n("Rim Runner"),t.threePA_rate>=.3&&t.threeP>=.35&&n("Stretch Big"),(t.astPct>=14||t.threePA_rate>=.25)&&n("Connector")):a&&(n("Connector"),t.paceZ>=.25&&t.impact>=4&&n("Switch Big")),Array.from(e)}function ge(t,e){var a;let r=e instanceof Map?e.get(t.id):e&&typeof e=="object"?e[t.id]:void 0;if(r&&r.length)return de(r);let n=de((a=t.archetypes)!=null?a:ea);if(n.length)return n;let o=de(na(t));if(o.length)return o;let i=de(oa(t));return i.length?i:["Connector"]}var ia=["current","nineties","pre3","oldschool"],It={current:{poss:100,threeFactor:1,spacingBonus:1,postBoost:0,handcheck:0,orb:1,variance:1},nineties:{poss:88,threeFactor:.7,spacingBonus:.8,postBoost:3,handcheck:2,orb:1.1,variance:1.05},pre3:{poss:96,threeFactor:0,spacingBonus:.3,postBoost:4,handcheck:1,orb:1.15,variance:1.1},oldschool:{poss:70,threeFactor:0,spacingBonus:0,postBoost:5,handcheck:3,orb:1.2,variance:1.2}};function dt(t){return typeof t=="string"&&ia.includes(t)}function aa(t){return typeof window!="undefined"&&typeof window.btoa=="function"?window.btoa(t):Buffer.from(t,"utf8").toString("base64")}function sa(t){return typeof window!="undefined"&&typeof window.atob=="function"?window.atob(t):Buffer.from(t,"base64").toString("utf8")}function xe(t){return Array.isArray(t)?t.map(e=>typeof e=="string"||typeof e=="number"?String(e):null).filter(e=>!!(e&&e.trim().length)):[]}function ua(t){let e=en(t.style,t.eraNorm),r={a:xe(t.a),b:xe(t.b)};(Object.prototype.propertyIsEnumerable.call(t,"style")||e!=="current"&&e!=="nineties")&&(r.style=e);let o=typeof t.eraNorm=="boolean"?t.eraNorm:e!=="current"?!0:void 0;return typeof o=="boolean"&&(r.eraNorm=o),aa(JSON.stringify(r))}function ye(t){if(!t)return null;try{let e=JSON.parse(sa(t)),r=typeof(e==null?void 0:e.eraNorm)=="boolean"?e.eraNorm:void 0,n=en(e==null?void 0:e.style,r),o=typeof r=="boolean"?r:n!=="current"?!0:void 0,i={a:xe(e==null?void 0:e.a),b:xe(e==null?void 0:e.b),style:n};return typeof o=="boolean"&&(i.eraNorm=o),Object.defineProperty(i,"style",{value:n,enumerable:!1,writable:!0,configurable:!0}),i}catch(e){return console.warn("Unable to decode rumble hash",e),null}}function Jr(){let t=window.location.hash.slice(1);if(!t.startsWith("rumble="))return null;let e=t.slice(7);return ye(e)}function tn(t){let r=`#rumble=${ua(t)}`;window.location.hash!==r&&window.history.replaceState({},"Roster Rumble",`${window.location.pathname}${window.location.search}${r}`)}function en(t,e){return dt(t)?t:typeof e=="boolean"&&e?"nineties":"current"}function At(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function nr(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function be(t){let e,r,n;t.length!==2?(e=At,r=(s,l)=>At(t(s),l),n=(s,l)=>t(s)-l):(e=t===At||t===nr?t:la,r=t,n=t);function o(s,l,u=0,m=s.length){if(u<m){if(e(l,l)!==0)return m;do{let h=u+m>>>1;r(s[h],l)<0?u=h+1:m=h}while(u<m)}return u}function i(s,l,u=0,m=s.length){if(u<m){if(e(l,l)!==0)return m;do{let h=u+m>>>1;r(s[h],l)<=0?u=h+1:m=h}while(u<m)}return u}function a(s,l,u=0,m=s.length){let h=o(s,l,u,m-1);return h>u&&n(s[h-1],l)>-n(s[h],l)?h-1:h}return{left:o,center:a,right:i}}function la(){return 0}function or(t){return t===null?NaN:+t}var rn=be(At),nn=rn.right,fa=rn.left,ca=be(or).center,Yt=nn;function ir(t,e){let r=0;if(e===void 0)for(let n of t)n!=null&&(n=+n)>=n&&++r;else{let n=-1;for(let o of t)(o=e(o,++n,t))!=null&&(o=+o)>=o&&++r}return r}function gt(t,e){let r,n;if(e===void 0)for(let o of t)o!=null&&(r===void 0?o>=o&&(r=n=o):(r>o&&(r=o),n<o&&(n=o)));else{let o=-1;for(let i of t)(i=e(i,++o,t))!=null&&(r===void 0?i>=i&&(r=n=i):(r>i&&(r=i),n<i&&(n=i)))}return[r,n]}function ar(t){return t}var on=Array.prototype,an=on.slice,Ll=on.map;function Vt(t){return()=>t}var ma=Math.sqrt(50),ha=Math.sqrt(10),pa=Math.sqrt(2);function ve(t,e,r){let n=(e-t)/Math.max(0,r),o=Math.floor(Math.log10(n)),i=n/Math.pow(10,o),a=i>=ma?10:i>=ha?5:i>=pa?2:1,s,l,u;return o<0?(u=Math.pow(10,-o)/a,s=Math.round(t*u),l=Math.round(e*u),s/u<t&&++s,l/u>e&&--l,u=-u):(u=Math.pow(10,o)*a,s=Math.round(t/u),l=Math.round(e/u),s*u<t&&++s,l*u>e&&--l),l<s&&.5<=r&&r<2?ve(t,e,r*2):[s,l,u]}function Ot(t,e,r){if(e=+e,t=+t,r=+r,!(r>0))return[];if(t===e)return[t];let n=e<t,[o,i,a]=n?ve(e,t,r):ve(t,e,r);if(!(i>=o))return[];let s=i-o+1,l=new Array(s);if(n)if(a<0)for(let u=0;u<s;++u)l[u]=(i-u)/-a;else for(let u=0;u<s;++u)l[u]=(i-u)*a;else if(a<0)for(let u=0;u<s;++u)l[u]=(o+u)/-a;else for(let u=0;u<s;++u)l[u]=(o+u)*a;return l}function at(t,e,r){return e=+e,t=+t,r=+r,ve(t,e,r)[2]}function sr(t,e,r){e=+e,t=+t,r=+r;let n=e<t,o=n?at(e,t,r):at(t,e,r);return(n?-1:1)*(o<0?1/-o:o)}function ur(t,e,r){let n;for(;;){let o=at(t,e,r);if(o===n||o===0||!isFinite(o))return[t,e];o>0?(t=Math.floor(t/o)*o,e=Math.ceil(e/o)*o):o<0&&(t=Math.ceil(t*o)/o,e=Math.floor(e*o)/o),n=o}}function lr(t){return Math.max(1,Math.ceil(Math.log(ir(t))/Math.LN2)+1)}function Xt(){var t=ar,e=gt,r=lr;function n(o){Array.isArray(o)||(o=Array.from(o));var i,a=o.length,s,l,u=new Array(a);for(i=0;i<a;++i)u[i]=t(o[i],i,o);var m=e(u),h=m[0],f=m[1],c=r(u,h,f);if(!Array.isArray(c)){let b=f,v=+c;if(e===gt&&([h,f]=ur(h,f,v)),c=Ot(h,f,v),c[0]<=h&&(l=at(h,f,v)),c[c.length-1]>=f)if(b>=f&&e===gt){let w=at(h,f,v);isFinite(w)&&(w>0?f=(Math.floor(f/w)+1)*w:w<0&&(f=(Math.ceil(f*-w)+1)/-w))}else c.pop()}for(var g=c.length,p=0,d=g;c[p]<=h;)++p;for(;c[d-1]>f;)--d;(p||d<g)&&(c=c.slice(p,d),g=d-p);var y=new Array(g+1),x;for(i=0;i<=g;++i)x=y[i]=[],x.x0=i>0?c[i-1]:h,x.x1=i<g?c[i]:f;if(isFinite(l)){if(l>0)for(i=0;i<a;++i)(s=u[i])!=null&&h<=s&&s<=f&&y[Math.min(g,Math.floor((s-h)/l))].push(o[i]);else if(l<0){for(i=0;i<a;++i)if((s=u[i])!=null&&h<=s&&s<=f){let b=Math.floor((h-s)*l);y[Math.min(g,b+(c[b]<=s))].push(o[i])}}}else for(i=0;i<a;++i)(s=u[i])!=null&&h<=s&&s<=f&&y[Yt(c,s,0,g)].push(o[i]);return y}return n.value=function(o){return arguments.length?(t=typeof o=="function"?o:Vt(o),n):t},n.domain=function(o){return arguments.length?(e=typeof o=="function"?o:Vt([o[0],o[1]]),n):e},n.thresholds=function(o){return arguments.length?(r=typeof o=="function"?o:Vt(Array.isArray(o)?an.call(o):o),n):r},n}function Ut(t,e){let r;if(e===void 0)for(let n of t)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);else{let n=-1;for(let o of t)(o=e(o,++n,t))!=null&&(r<o||r===void 0&&o>=o)&&(r=o)}return r}function we(t,e){let r;if(e===void 0)for(let n of t)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);else{let n=-1;for(let o of t)(o=e(o,++n,t))!=null&&(r>o||r===void 0&&o>=o)&&(r=o)}return r}function sn(t){return t}var fr=1,cr=2,mr=3,_e=4,un=1e-6;function da(t){return"translate("+t+",0)"}function ga(t){return"translate(0,"+t+")"}function xa(t){return e=>+t(e)}function ya(t,e){return e=Math.max(0,t.bandwidth()-e*2)/2,t.round()&&(e=Math.round(e)),r=>+t(r)+e}function ba(){return!this.__axis}function va(t,e){var r=[],n=null,o=null,i=6,a=6,s=3,l=typeof window!="undefined"&&window.devicePixelRatio>1?0:.5,u=t===fr||t===_e?-1:1,m=t===_e||t===cr?"x":"y",h=t===fr||t===mr?da:ga;function f(c){var g=n==null?e.ticks?e.ticks.apply(e,r):e.domain():n,p=o==null?e.tickFormat?e.tickFormat.apply(e,r):sn:o,d=Math.max(i,0)+s,y=e.range(),x=+y[0]+l,b=+y[y.length-1]+l,v=(e.bandwidth?ya:xa)(e.copy(),l),w=c.selection?c.selection():c,E=w.selectAll(".domain").data([null]),P=w.selectAll(".tick").data(g,e).order(),N=P.exit(),O=P.enter().append("g").attr("class","tick"),M=P.select("line"),_=P.select("text");E=E.merge(E.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),P=P.merge(O),M=M.merge(O.append("line").attr("stroke","currentColor").attr(m+"2",u*i)),_=_.merge(O.append("text").attr("fill","currentColor").attr(m,u*d).attr("dy",t===fr?"0em":t===mr?"0.71em":"0.32em")),c!==w&&(E=E.transition(c),P=P.transition(c),M=M.transition(c),_=_.transition(c),N=N.transition(c).attr("opacity",un).attr("transform",function(B){return isFinite(B=v(B))?h(B+l):this.getAttribute("transform")}),O.attr("opacity",un).attr("transform",function(B){var C=this.parentNode.__axis;return h((C&&isFinite(C=C(B))?C:v(B))+l)})),N.remove(),E.attr("d",t===_e||t===cr?a?"M"+u*a+","+x+"H"+l+"V"+b+"H"+u*a:"M"+l+","+x+"V"+b:a?"M"+x+","+u*a+"V"+l+"H"+b+"V"+u*a:"M"+x+","+l+"H"+b),P.attr("opacity",1).attr("transform",function(B){return h(v(B)+l)}),M.attr(m+"2",u*i),_.attr(m,u*d).text(p),w.filter(ba).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===cr?"start":t===_e?"end":"middle"),w.each(function(){this.__axis=v})}return f.scale=function(c){return arguments.length?(e=c,f):e},f.ticks=function(){return r=Array.from(arguments),f},f.tickArguments=function(c){return arguments.length?(r=c==null?[]:Array.from(c),f):r.slice()},f.tickValues=function(c){return arguments.length?(n=c==null?null:Array.from(c),f):n&&n.slice()},f.tickFormat=function(c){return arguments.length?(o=c,f):o},f.tickSize=function(c){return arguments.length?(i=a=+c,f):i},f.tickSizeInner=function(c){return arguments.length?(i=+c,f):i},f.tickSizeOuter=function(c){return arguments.length?(a=+c,f):a},f.tickPadding=function(c){return arguments.length?(s=+c,f):s},f.offset=function(c){return arguments.length?(l=+c,f):l},f}function hr(t){return va(mr,t)}var wa={value:()=>{}};function fn(){for(var t=0,e=arguments.length,r={},n;t<e;++t){if(!(n=arguments[t]+"")||n in r||/[\s.]/.test(n))throw new Error("illegal type: "+n);r[n]=[]}return new Se(r)}function Se(t){this._=t}function _a(t,e){return t.trim().split(/^|\s+/).map(function(r){var n="",o=r.indexOf(".");if(o>=0&&(n=r.slice(o+1),r=r.slice(0,o)),r&&!e.hasOwnProperty(r))throw new Error("unknown type: "+r);return{type:r,name:n}})}Se.prototype=fn.prototype={constructor:Se,on:function(t,e){var r=this._,n=_a(t+"",r),o,i=-1,a=n.length;if(arguments.length<2){for(;++i<a;)if((o=(t=n[i]).type)&&(o=Sa(r[o],t.name)))return o;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++i<a;)if(o=(t=n[i]).type)r[o]=ln(r[o],t.name,e);else if(e==null)for(o in r)r[o]=ln(r[o],t.name,null);return this},copy:function(){var t={},e=this._;for(var r in e)t[r]=e[r].slice();return new Se(t)},call:function(t,e){if((o=arguments.length-2)>0)for(var r=new Array(o),n=0,o,i;n<o;++n)r[n]=arguments[n+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(i=this._[t],n=0,o=i.length;n<o;++n)i[n].value.apply(e,r)},apply:function(t,e,r){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var n=this._[t],o=0,i=n.length;o<i;++o)n[o].value.apply(e,r)}};function Sa(t,e){for(var r=0,n=t.length,o;r<n;++r)if((o=t[r]).name===e)return o.value}function ln(t,e,r){for(var n=0,o=t.length;n<o;++n)if(t[n].name===e){t[n]=wa,t=t.slice(0,n).concat(t.slice(n+1));break}return r!=null&&t.push({name:e,value:r}),t}var Wt=fn;var Ae="http://www.w3.org/1999/xhtml",pr={svg:"http://www.w3.org/2000/svg",xhtml:Ae,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function ft(t){var e=t+="",r=e.indexOf(":");return r>=0&&(e=t.slice(0,r))!=="xmlns"&&(t=t.slice(r+1)),pr.hasOwnProperty(e)?{space:pr[e],local:t}:t}function Aa(t){return function(){var e=this.ownerDocument,r=this.namespaceURI;return r===Ae&&e.documentElement.namespaceURI===Ae?e.createElement(t):e.createElementNS(r,t)}}function Ma(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Me(t){var e=ft(t);return(e.local?Ma:Aa)(e)}function Ea(){}function Mt(t){return t==null?Ea:function(){return this.querySelector(t)}}function cn(t){typeof t!="function"&&(t=Mt(t));for(var e=this._groups,r=e.length,n=new Array(r),o=0;o<r;++o)for(var i=e[o],a=i.length,s=n[o]=new Array(a),l,u,m=0;m<a;++m)(l=i[m])&&(u=t.call(l,l.__data__,m,i))&&("__data__"in l&&(u.__data__=l.__data__),s[m]=u);return new F(n,this._parents)}function dr(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function ka(){return[]}function Zt(t){return t==null?ka:function(){return this.querySelectorAll(t)}}function Pa(t){return function(){return dr(t.apply(this,arguments))}}function mn(t){typeof t=="function"?t=Pa(t):t=Zt(t);for(var e=this._groups,r=e.length,n=[],o=[],i=0;i<r;++i)for(var a=e[i],s=a.length,l,u=0;u<s;++u)(l=a[u])&&(n.push(t.call(l,l.__data__,u,a)),o.push(l));return new F(n,o)}function Kt(t){return function(){return this.matches(t)}}function Ee(t){return function(e){return e.matches(t)}}var Na=Array.prototype.find;function Ca(t){return function(){return Na.call(this.children,t)}}function Ba(){return this.firstElementChild}function hn(t){return this.select(t==null?Ba:Ca(typeof t=="function"?t:Ee(t)))}var Ra=Array.prototype.filter;function Ta(){return Array.from(this.children)}function Ia(t){return function(){return Ra.call(this.children,t)}}function pn(t){return this.selectAll(t==null?Ta:Ia(typeof t=="function"?t:Ee(t)))}function dn(t){typeof t!="function"&&(t=Kt(t));for(var e=this._groups,r=e.length,n=new Array(r),o=0;o<r;++o)for(var i=e[o],a=i.length,s=n[o]=[],l,u=0;u<a;++u)(l=i[u])&&t.call(l,l.__data__,u,i)&&s.push(l);return new F(n,this._parents)}function ke(t){return new Array(t.length)}function gn(){return new F(this._enter||this._groups.map(ke),this._parents)}function Qt(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}Qt.prototype={constructor:Qt,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function xn(t){return function(){return t}}function Oa(t,e,r,n,o,i){for(var a=0,s,l=e.length,u=i.length;a<u;++a)(s=e[a])?(s.__data__=i[a],n[a]=s):r[a]=new Qt(t,i[a]);for(;a<l;++a)(s=e[a])&&(o[a]=s)}function La(t,e,r,n,o,i,a){var s,l,u=new Map,m=e.length,h=i.length,f=new Array(m),c;for(s=0;s<m;++s)(l=e[s])&&(f[s]=c=a.call(l,l.__data__,s,e)+"",u.has(c)?o[s]=l:u.set(c,l));for(s=0;s<h;++s)c=a.call(t,i[s],s,i)+"",(l=u.get(c))?(n[s]=l,l.__data__=i[s],u.delete(c)):r[s]=new Qt(t,i[s]);for(s=0;s<m;++s)(l=e[s])&&u.get(f[s])===l&&(o[s]=l)}function za(t){return t.__data__}function yn(t,e){if(!arguments.length)return Array.from(this,za);var r=e?La:Oa,n=this._parents,o=this._groups;typeof t!="function"&&(t=xn(t));for(var i=o.length,a=new Array(i),s=new Array(i),l=new Array(i),u=0;u<i;++u){var m=n[u],h=o[u],f=h.length,c=$a(t.call(m,m&&m.__data__,u,n)),g=c.length,p=s[u]=new Array(g),d=a[u]=new Array(g),y=l[u]=new Array(f);r(m,h,p,d,y,c,e);for(var x=0,b=0,v,w;x<g;++x)if(v=p[x]){for(x>=b&&(b=x+1);!(w=d[b])&&++b<g;);v._next=w||null}}return a=new F(a,n),a._enter=s,a._exit=l,a}function $a(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function bn(){return new F(this._exit||this._groups.map(ke),this._parents)}function vn(t,e,r){var n=this.enter(),o=this,i=this.exit();return typeof t=="function"?(n=t(n),n&&(n=n.selection())):n=n.append(t+""),e!=null&&(o=e(o),o&&(o=o.selection())),r==null?i.remove():r(i),n&&o?n.merge(o).order():o}function wn(t){for(var e=t.selection?t.selection():t,r=this._groups,n=e._groups,o=r.length,i=n.length,a=Math.min(o,i),s=new Array(o),l=0;l<a;++l)for(var u=r[l],m=n[l],h=u.length,f=s[l]=new Array(h),c,g=0;g<h;++g)(c=u[g]||m[g])&&(f[g]=c);for(;l<o;++l)s[l]=r[l];return new F(s,this._parents)}function _n(){for(var t=this._groups,e=-1,r=t.length;++e<r;)for(var n=t[e],o=n.length-1,i=n[o],a;--o>=0;)(a=n[o])&&(i&&a.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(a,i),i=a);return this}function Sn(t){t||(t=Fa);function e(h,f){return h&&f?t(h.__data__,f.__data__):!h-!f}for(var r=this._groups,n=r.length,o=new Array(n),i=0;i<n;++i){for(var a=r[i],s=a.length,l=o[i]=new Array(s),u,m=0;m<s;++m)(u=a[m])&&(l[m]=u);l.sort(e)}return new F(o,this._parents).order()}function Fa(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function An(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function Mn(){return Array.from(this)}function En(){for(var t=this._groups,e=0,r=t.length;e<r;++e)for(var n=t[e],o=0,i=n.length;o<i;++o){var a=n[o];if(a)return a}return null}function kn(){let t=0;for(let e of this)++t;return t}function Pn(){return!this.node()}function Nn(t){for(var e=this._groups,r=0,n=e.length;r<n;++r)for(var o=e[r],i=0,a=o.length,s;i<a;++i)(s=o[i])&&t.call(s,s.__data__,i,o);return this}function qa(t){return function(){this.removeAttribute(t)}}function Da(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Ha(t,e){return function(){this.setAttribute(t,e)}}function Ga(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function Ya(t,e){return function(){var r=e.apply(this,arguments);r==null?this.removeAttribute(t):this.setAttribute(t,r)}}function Va(t,e){return function(){var r=e.apply(this,arguments);r==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,r)}}function Cn(t,e){var r=ft(t);if(arguments.length<2){var n=this.node();return r.local?n.getAttributeNS(r.space,r.local):n.getAttribute(r)}return this.each((e==null?r.local?Da:qa:typeof e=="function"?r.local?Va:Ya:r.local?Ga:Ha)(r,e))}function Pe(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Xa(t){return function(){this.style.removeProperty(t)}}function Ua(t,e,r){return function(){this.style.setProperty(t,e,r)}}function Wa(t,e,r){return function(){var n=e.apply(this,arguments);n==null?this.style.removeProperty(t):this.style.setProperty(t,n,r)}}function Bn(t,e,r){return arguments.length>1?this.each((e==null?Xa:typeof e=="function"?Wa:Ua)(t,e,r==null?"":r)):xt(this.node(),t)}function xt(t,e){return t.style.getPropertyValue(e)||Pe(t).getComputedStyle(t,null).getPropertyValue(e)}function Za(t){return function(){delete this[t]}}function Ka(t,e){return function(){this[t]=e}}function Qa(t,e){return function(){var r=e.apply(this,arguments);r==null?delete this[t]:this[t]=r}}function Rn(t,e){return arguments.length>1?this.each((e==null?Za:typeof e=="function"?Qa:Ka)(t,e)):this.node()[t]}function Tn(t){return t.trim().split(/^|\s+/)}function gr(t){return t.classList||new In(t)}function In(t){this._node=t,this._names=Tn(t.getAttribute("class")||"")}In.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function On(t,e){for(var r=gr(t),n=-1,o=e.length;++n<o;)r.add(e[n])}function Ln(t,e){for(var r=gr(t),n=-1,o=e.length;++n<o;)r.remove(e[n])}function ja(t){return function(){On(this,t)}}function Ja(t){return function(){Ln(this,t)}}function ts(t,e){return function(){(e.apply(this,arguments)?On:Ln)(this,t)}}function zn(t,e){var r=Tn(t+"");if(arguments.length<2){for(var n=gr(this.node()),o=-1,i=r.length;++o<i;)if(!n.contains(r[o]))return!1;return!0}return this.each((typeof e=="function"?ts:e?ja:Ja)(r,e))}function es(){this.textContent=""}function rs(t){return function(){this.textContent=t}}function ns(t){return function(){var e=t.apply(this,arguments);this.textContent=e==null?"":e}}function $n(t){return arguments.length?this.each(t==null?es:(typeof t=="function"?ns:rs)(t)):this.node().textContent}function os(){this.innerHTML=""}function is(t){return function(){this.innerHTML=t}}function as(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e==null?"":e}}function Fn(t){return arguments.length?this.each(t==null?os:(typeof t=="function"?as:is)(t)):this.node().innerHTML}function ss(){this.nextSibling&&this.parentNode.appendChild(this)}function qn(){return this.each(ss)}function us(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Dn(){return this.each(us)}function Hn(t){var e=typeof t=="function"?t:Me(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function ls(){return null}function Gn(t,e){var r=typeof t=="function"?t:Me(t),n=e==null?ls:typeof e=="function"?e:Mt(e);return this.select(function(){return this.insertBefore(r.apply(this,arguments),n.apply(this,arguments)||null)})}function fs(){var t=this.parentNode;t&&t.removeChild(this)}function Yn(){return this.each(fs)}function cs(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function ms(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Vn(t){return this.select(t?ms:cs)}function Xn(t){return arguments.length?this.property("__data__",t):this.node().__data__}function hs(t){return function(e){t.call(this,e,this.__data__)}}function ps(t){return t.trim().split(/^|\s+/).map(function(e){var r="",n=e.indexOf(".");return n>=0&&(r=e.slice(n+1),e=e.slice(0,n)),{type:e,name:r}})}function ds(t){return function(){var e=this.__on;if(e){for(var r=0,n=-1,o=e.length,i;r<o;++r)i=e[r],(!t.type||i.type===t.type)&&i.name===t.name?this.removeEventListener(i.type,i.listener,i.options):e[++n]=i;++n?e.length=n:delete this.__on}}}function gs(t,e,r){return function(){var n=this.__on,o,i=hs(e);if(n){for(var a=0,s=n.length;a<s;++a)if((o=n[a]).type===t.type&&o.name===t.name){this.removeEventListener(o.type,o.listener,o.options),this.addEventListener(o.type,o.listener=i,o.options=r),o.value=e;return}}this.addEventListener(t.type,i,r),o={type:t.type,name:t.name,value:e,listener:i,options:r},n?n.push(o):this.__on=[o]}}function Un(t,e,r){var n=ps(t+""),o,i=n.length,a;if(arguments.length<2){var s=this.node().__on;if(s){for(var l=0,u=s.length,m;l<u;++l)for(o=0,m=s[l];o<i;++o)if((a=n[o]).type===m.type&&a.name===m.name)return m.value}return}for(s=e?gs:ds,o=0;o<i;++o)this.each(s(n[o],e,r));return this}function Wn(t,e,r){var n=Pe(t),o=n.CustomEvent;typeof o=="function"?o=new o(e,r):(o=n.document.createEvent("Event"),r?(o.initEvent(e,r.bubbles,r.cancelable),o.detail=r.detail):o.initEvent(e,!1,!1)),t.dispatchEvent(o)}function xs(t,e){return function(){return Wn(this,t,e)}}function ys(t,e){return function(){return Wn(this,t,e.apply(this,arguments))}}function Zn(t,e){return this.each((typeof e=="function"?ys:xs)(t,e))}function*Kn(){for(var t=this._groups,e=0,r=t.length;e<r;++e)for(var n=t[e],o=0,i=n.length,a;o<i;++o)(a=n[o])&&(yield a)}var xr=[null];function F(t,e){this._groups=t,this._parents=e}function Qn(){return new F([[document.documentElement]],xr)}function bs(){return this}F.prototype=Qn.prototype={constructor:F,select:cn,selectAll:mn,selectChild:hn,selectChildren:pn,filter:dn,data:yn,enter:gn,exit:bn,join:vn,merge:wn,selection:bs,order:_n,sort:Sn,call:An,nodes:Mn,node:En,size:kn,empty:Pn,each:Nn,attr:Cn,style:Bn,property:Rn,classed:zn,text:$n,html:Fn,raise:qn,lower:Dn,append:Hn,insert:Gn,remove:Yn,clone:Vn,datum:Xn,on:Un,dispatch:Zn,[Symbol.iterator]:Kn};var ct=Qn;function Lt(t){return typeof t=="string"?new F([[document.querySelector(t)]],[document.documentElement]):new F([[t]],xr)}function Ne(t,e,r){t.prototype=e.prototype=r,r.constructor=t}function yr(t,e){var r=Object.create(t.prototype);for(var n in e)r[n]=e[n];return r}function te(){}var jt=.7,Re=1/jt,zt="\\s*([+-]?\\d+)\\s*",Jt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",st="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",vs=/^#([0-9a-f]{3,8})$/,ws=new RegExp(`^rgb\\(${zt},${zt},${zt}\\)$`),_s=new RegExp(`^rgb\\(${st},${st},${st}\\)$`),Ss=new RegExp(`^rgba\\(${zt},${zt},${zt},${Jt}\\)$`),As=new RegExp(`^rgba\\(${st},${st},${st},${Jt}\\)$`),Ms=new RegExp(`^hsl\\(${Jt},${st},${st}\\)$`),Es=new RegExp(`^hsla\\(${Jt},${st},${st},${Jt}\\)$`),jn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Ne(te,nt,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Jn,formatHex:Jn,formatHex8:ks,formatHsl:Ps,formatRgb:to,toString:to});function Jn(){return this.rgb().formatHex()}function ks(){return this.rgb().formatHex8()}function Ps(){return ao(this).formatHsl()}function to(){return this.rgb().formatRgb()}function nt(t){var e,r;return t=(t+"").trim().toLowerCase(),(e=vs.exec(t))?(r=e[1].length,e=parseInt(e[1],16),r===6?eo(e):r===3?new K(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):r===8?Ce(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):r===4?Ce(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=ws.exec(t))?new K(e[1],e[2],e[3],1):(e=_s.exec(t))?new K(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=Ss.exec(t))?Ce(e[1],e[2],e[3],e[4]):(e=As.exec(t))?Ce(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=Ms.exec(t))?oo(e[1],e[2]/100,e[3]/100,1):(e=Es.exec(t))?oo(e[1],e[2]/100,e[3]/100,e[4]):jn.hasOwnProperty(t)?eo(jn[t]):t==="transparent"?new K(NaN,NaN,NaN,0):null}function eo(t){return new K(t>>16&255,t>>8&255,t&255,1)}function Ce(t,e,r,n){return n<=0&&(t=e=r=NaN),new K(t,e,r,n)}function Ns(t){return t instanceof te||(t=nt(t)),t?(t=t.rgb(),new K(t.r,t.g,t.b,t.opacity)):new K}function $t(t,e,r,n){return arguments.length===1?Ns(t):new K(t,e,r,n==null?1:n)}function K(t,e,r,n){this.r=+t,this.g=+e,this.b=+r,this.opacity=+n}Ne(K,$t,yr(te,{brighter(t){return t=t==null?Re:Math.pow(Re,t),new K(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?jt:Math.pow(jt,t),new K(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new K(kt(this.r),kt(this.g),kt(this.b),Te(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:ro,formatHex:ro,formatHex8:Cs,formatRgb:no,toString:no}));function ro(){return`#${Et(this.r)}${Et(this.g)}${Et(this.b)}`}function Cs(){return`#${Et(this.r)}${Et(this.g)}${Et(this.b)}${Et((isNaN(this.opacity)?1:this.opacity)*255)}`}function no(){let t=Te(this.opacity);return`${t===1?"rgb(":"rgba("}${kt(this.r)}, ${kt(this.g)}, ${kt(this.b)}${t===1?")":`, ${t})`}`}function Te(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function kt(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Et(t){return t=kt(t),(t<16?"0":"")+t.toString(16)}function oo(t,e,r,n){return n<=0?t=e=r=NaN:r<=0||r>=1?t=e=NaN:e<=0&&(t=NaN),new rt(t,e,r,n)}function ao(t){if(t instanceof rt)return new rt(t.h,t.s,t.l,t.opacity);if(t instanceof te||(t=nt(t)),!t)return new rt;if(t instanceof rt)return t;t=t.rgb();var e=t.r/255,r=t.g/255,n=t.b/255,o=Math.min(e,r,n),i=Math.max(e,r,n),a=NaN,s=i-o,l=(i+o)/2;return s?(e===i?a=(r-n)/s+(r<n)*6:r===i?a=(n-e)/s+2:a=(e-r)/s+4,s/=l<.5?i+o:2-i-o,a*=60):s=l>0&&l<1?0:a,new rt(a,s,l,t.opacity)}function so(t,e,r,n){return arguments.length===1?ao(t):new rt(t,e,r,n==null?1:n)}function rt(t,e,r,n){this.h=+t,this.s=+e,this.l=+r,this.opacity=+n}Ne(rt,so,yr(te,{brighter(t){return t=t==null?Re:Math.pow(Re,t),new rt(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?jt:Math.pow(jt,t),new rt(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*e,o=2*r-n;return new K(br(t>=240?t-240:t+120,o,n),br(t,o,n),br(t<120?t+240:t-120,o,n),this.opacity)},clamp(){return new rt(io(this.h),Be(this.s),Be(this.l),Te(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){let t=Te(this.opacity);return`${t===1?"hsl(":"hsla("}${io(this.h)}, ${Be(this.s)*100}%, ${Be(this.l)*100}%${t===1?")":`, ${t})`}`}}));function io(t){return t=(t||0)%360,t<0?t+360:t}function Be(t){return Math.max(0,Math.min(1,t||0))}function br(t,e,r){return(t<60?e+(r-e)*t/60:t<180?r:t<240?e+(r-e)*(240-t)/60:e)*255}function vr(t,e,r,n,o){var i=t*t,a=i*t;return((1-3*t+3*i-a)*e+(4-6*i+3*a)*r+(1+3*t+3*i-3*a)*n+a*o)/6}function uo(t){var e=t.length-1;return function(r){var n=r<=0?r=0:r>=1?(r=1,e-1):Math.floor(r*e),o=t[n],i=t[n+1],a=n>0?t[n-1]:2*o-i,s=n<e-1?t[n+2]:2*i-o;return vr((r-n/e)*e,a,o,i,s)}}function lo(t){var e=t.length;return function(r){var n=Math.floor(((r%=1)<0?++r:r)*e),o=t[(n+e-1)%e],i=t[n%e],a=t[(n+1)%e],s=t[(n+2)%e];return vr((r-n/e)*e,o,i,a,s)}}var ee=t=>()=>t;function Bs(t,e){return function(r){return t+r*e}}function Rs(t,e,r){return t=Math.pow(t,r),e=Math.pow(e,r)-t,r=1/r,function(n){return Math.pow(t+n*e,r)}}function fo(t){return(t=+t)==1?Ie:function(e,r){return r-e?Rs(e,r,t):ee(isNaN(e)?r:e)}}function Ie(t,e){var r=e-t;return r?Bs(t,r):ee(isNaN(t)?e:t)}var Pt=function t(e){var r=fo(e);function n(o,i){var a=r((o=$t(o)).r,(i=$t(i)).r),s=r(o.g,i.g),l=r(o.b,i.b),u=Ie(o.opacity,i.opacity);return function(m){return o.r=a(m),o.g=s(m),o.b=l(m),o.opacity=u(m),o+""}}return n.gamma=t,n}(1);function co(t){return function(e){var r=e.length,n=new Array(r),o=new Array(r),i=new Array(r),a,s;for(a=0;a<r;++a)s=$t(e[a]),n[a]=s.r||0,o[a]=s.g||0,i[a]=s.b||0;return n=t(n),o=t(o),i=t(i),s.opacity=1,function(l){return s.r=n(l),s.g=o(l),s.b=i(l),s+""}}}var wr=co(uo),Ts=co(lo);function mo(t,e){e||(e=[]);var r=t?Math.min(e.length,t.length):0,n=e.slice(),o;return function(i){for(o=0;o<r;++o)n[o]=t[o]*(1-i)+e[o]*i;return n}}function ho(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function po(t,e){var r=e?e.length:0,n=t?Math.min(r,t.length):0,o=new Array(n),i=new Array(r),a;for(a=0;a<n;++a)o[a]=ot(t[a],e[a]);for(;a<r;++a)i[a]=e[a];return function(s){for(a=0;a<n;++a)i[a]=o[a](s);return i}}function go(t,e){var r=new Date;return t=+t,e=+e,function(n){return r.setTime(t*(1-n)+e*n),r}}function V(t,e){return t=+t,e=+e,function(r){return t*(1-r)+e*r}}function xo(t,e){var r={},n={},o;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(o in e)o in t?r[o]=ot(t[o],e[o]):n[o]=e[o];return function(i){for(o in r)n[o]=r[o](i);return n}}var Sr=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,_r=new RegExp(Sr.source,"g");function Is(t){return function(){return t}}function Os(t){return function(e){return t(e)+""}}function re(t,e){var r=Sr.lastIndex=_r.lastIndex=0,n,o,i,a=-1,s=[],l=[];for(t=t+"",e=e+"";(n=Sr.exec(t))&&(o=_r.exec(e));)(i=o.index)>r&&(i=e.slice(r,i),s[a]?s[a]+=i:s[++a]=i),(n=n[0])===(o=o[0])?s[a]?s[a]+=o:s[++a]=o:(s[++a]=null,l.push({i:a,x:V(n,o)})),r=_r.lastIndex;return r<e.length&&(i=e.slice(r),s[a]?s[a]+=i:s[++a]=i),s.length<2?l[0]?Os(l[0].x):Is(e):(e=l.length,function(u){for(var m=0,h;m<e;++m)s[(h=l[m]).i]=h.x(u);return s.join("")})}function ot(t,e){var r=typeof e,n;return e==null||r==="boolean"?ee(e):(r==="number"?V:r==="string"?(n=nt(e))?(e=n,Pt):re:e instanceof nt?Pt:e instanceof Date?go:ho(e)?mo:Array.isArray(e)?po:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?xo:V)(t,e)}function ne(t,e){return t=+t,e=+e,function(r){return Math.round(t*(1-r)+e*r)}}var yo=180/Math.PI,Oe={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Ar(t,e,r,n,o,i){var a,s,l;return(a=Math.sqrt(t*t+e*e))&&(t/=a,e/=a),(l=t*r+e*n)&&(r-=t*l,n-=e*l),(s=Math.sqrt(r*r+n*n))&&(r/=s,n/=s,l/=s),t*n<e*r&&(t=-t,e=-e,l=-l,a=-a),{translateX:o,translateY:i,rotate:Math.atan2(e,t)*yo,skewX:Math.atan(l)*yo,scaleX:a,scaleY:s}}var Le;function bo(t){let e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Oe:Ar(e.a,e.b,e.c,e.d,e.e,e.f)}function vo(t){return t==null?Oe:(Le||(Le=document.createElementNS("http://www.w3.org/2000/svg","g")),Le.setAttribute("transform",t),(t=Le.transform.baseVal.consolidate())?(t=t.matrix,Ar(t.a,t.b,t.c,t.d,t.e,t.f)):Oe)}function wo(t,e,r,n){function o(u){return u.length?u.pop()+" ":""}function i(u,m,h,f,c,g){if(u!==h||m!==f){var p=c.push("translate(",null,e,null,r);g.push({i:p-4,x:V(u,h)},{i:p-2,x:V(m,f)})}else(h||f)&&c.push("translate("+h+e+f+r)}function a(u,m,h,f){u!==m?(u-m>180?m+=360:m-u>180&&(u+=360),f.push({i:h.push(o(h)+"rotate(",null,n)-2,x:V(u,m)})):m&&h.push(o(h)+"rotate("+m+n)}function s(u,m,h,f){u!==m?f.push({i:h.push(o(h)+"skewX(",null,n)-2,x:V(u,m)}):m&&h.push(o(h)+"skewX("+m+n)}function l(u,m,h,f,c,g){if(u!==h||m!==f){var p=c.push(o(c)+"scale(",null,",",null,")");g.push({i:p-4,x:V(u,h)},{i:p-2,x:V(m,f)})}else(h!==1||f!==1)&&c.push(o(c)+"scale("+h+","+f+")")}return function(u,m){var h=[],f=[];return u=t(u),m=t(m),i(u.translateX,u.translateY,m.translateX,m.translateY,h,f),a(u.rotate,m.rotate,h,f),s(u.skewX,m.skewX,h,f),l(u.scaleX,u.scaleY,m.scaleX,m.scaleY,h,f),u=m=null,function(c){for(var g=-1,p=f.length,d;++g<p;)h[(d=f[g]).i]=d.x(c);return h.join("")}}}var Mr=wo(bo,"px, ","px)","deg)"),Er=wo(vo,", ",")",")");function ze(t,e){e===void 0&&(e=t,t=ot);for(var r=0,n=e.length-1,o=e[0],i=new Array(n<0?0:n);r<n;)i[r]=t(o,o=e[++r]);return function(a){var s=Math.max(0,Math.min(n-1,Math.floor(a*=n)));return i[s](a-s)}}var Ft=0,ie=0,oe=0,So=1e3,$e,ae,Fe=0,Nt=0,qe=0,se=typeof performance=="object"&&performance.now?performance:Date,Ao=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function le(){return Nt||(Ao(Ls),Nt=se.now()+qe)}function Ls(){Nt=0}function ue(){this._call=this._time=this._next=null}ue.prototype=qt.prototype={constructor:ue,restart:function(t,e,r){if(typeof t!="function")throw new TypeError("callback is not a function");r=(r==null?le():+r)+(e==null?0:+e),!this._next&&ae!==this&&(ae?ae._next=this:$e=this,ae=this),this._call=t,this._time=r,kr()},stop:function(){this._call&&(this._call=null,this._time=1/0,kr())}};function qt(t,e,r){var n=new ue;return n.restart(t,e,r),n}function Mo(){le(),++Ft;for(var t=$e,e;t;)(e=Nt-t._time)>=0&&t._call.call(void 0,e),t=t._next;--Ft}function _o(){Nt=(Fe=se.now())+qe,Ft=ie=0;try{Mo()}finally{Ft=0,$s(),Nt=0}}function zs(){var t=se.now(),e=t-Fe;e>So&&(qe-=e,Fe=t)}function $s(){for(var t,e=$e,r,n=1/0;e;)e._call?(n>e._time&&(n=e._time),t=e,e=e._next):(r=e._next,e._next=null,e=t?t._next=r:$e=r);ae=t,kr(n)}function kr(t){if(!Ft){ie&&(ie=clearTimeout(ie));var e=t-Nt;e>24?(t<1/0&&(ie=setTimeout(_o,t-se.now()-qe)),oe&&(oe=clearInterval(oe))):(oe||(Fe=se.now(),oe=setInterval(zs,So)),Ft=1,Ao(_o))}}function De(t,e,r){var n=new ue;return e=e==null?0:+e,n.restart(o=>{n.stop(),t(o+e)},e,r),n}var Fs=Wt("start","end","cancel","interrupt"),qs=[],Po=0,Eo=1,Ge=2,He=3,ko=4,Ye=5,fe=6;function yt(t,e,r,n,o,i){var a=t.__transition;if(!a)t.__transition={};else if(r in a)return;Ds(t,r,{name:e,index:n,group:o,on:Fs,tween:qs,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:Po})}function ce(t,e){var r=q(t,e);if(r.state>Po)throw new Error("too late; already scheduled");return r}function X(t,e){var r=q(t,e);if(r.state>He)throw new Error("too late; already running");return r}function q(t,e){var r=t.__transition;if(!r||!(r=r[e]))throw new Error("transition not found");return r}function Ds(t,e,r){var n=t.__transition,o;n[e]=r,r.timer=qt(i,0,r.time);function i(u){r.state=Eo,r.timer.restart(a,r.delay,r.time),r.delay<=u&&a(u-r.delay)}function a(u){var m,h,f,c;if(r.state!==Eo)return l();for(m in n)if(c=n[m],c.name===r.name){if(c.state===He)return De(a);c.state===ko?(c.state=fe,c.timer.stop(),c.on.call("interrupt",t,t.__data__,c.index,c.group),delete n[m]):+m<e&&(c.state=fe,c.timer.stop(),c.on.call("cancel",t,t.__data__,c.index,c.group),delete n[m])}if(De(function(){r.state===He&&(r.state=ko,r.timer.restart(s,r.delay,r.time),s(u))}),r.state=Ge,r.on.call("start",t,t.__data__,r.index,r.group),r.state===Ge){for(r.state=He,o=new Array(f=r.tween.length),m=0,h=-1;m<f;++m)(c=r.tween[m].value.call(t,t.__data__,r.index,r.group))&&(o[++h]=c);o.length=h+1}}function s(u){for(var m=u<r.duration?r.ease.call(null,u/r.duration):(r.timer.restart(l),r.state=Ye,1),h=-1,f=o.length;++h<f;)o[h].call(t,m);r.state===Ye&&(r.on.call("end",t,t.__data__,r.index,r.group),l())}function l(){r.state=fe,r.timer.stop(),delete n[e];for(var u in n)return;delete t.__transition}}function Ve(t,e){var r=t.__transition,n,o,i=!0,a;if(r){e=e==null?null:e+"";for(a in r){if((n=r[a]).name!==e){i=!1;continue}o=n.state>Ge&&n.state<Ye,n.state=fe,n.timer.stop(),n.on.call(o?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete r[a]}i&&delete t.__transition}}function No(t){return this.each(function(){Ve(this,t)})}function Hs(t,e){var r,n;return function(){var o=X(this,t),i=o.tween;if(i!==r){n=r=i;for(var a=0,s=n.length;a<s;++a)if(n[a].name===e){n=n.slice(),n.splice(a,1);break}}o.tween=n}}function Gs(t,e,r){var n,o;if(typeof r!="function")throw new Error;return function(){var i=X(this,t),a=i.tween;if(a!==n){o=(n=a).slice();for(var s={name:e,value:r},l=0,u=o.length;l<u;++l)if(o[l].name===e){o[l]=s;break}l===u&&o.push(s)}i.tween=o}}function Co(t,e){var r=this._id;if(t+="",arguments.length<2){for(var n=q(this.node(),r).tween,o=0,i=n.length,a;o<i;++o)if((a=n[o]).name===t)return a.value;return null}return this.each((e==null?Hs:Gs)(r,t,e))}function Dt(t,e,r){var n=t._id;return t.each(function(){var o=X(this,n);(o.value||(o.value={}))[e]=r.apply(this,arguments)}),function(o){return q(o,n).value[e]}}function Xe(t,e){var r;return(typeof e=="number"?V:e instanceof nt?Pt:(r=nt(e))?(e=r,Pt):re)(t,e)}function Ys(t){return function(){this.removeAttribute(t)}}function Vs(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Xs(t,e,r){var n,o=r+"",i;return function(){var a=this.getAttribute(t);return a===o?null:a===n?i:i=e(n=a,r)}}function Us(t,e,r){var n,o=r+"",i;return function(){var a=this.getAttributeNS(t.space,t.local);return a===o?null:a===n?i:i=e(n=a,r)}}function Ws(t,e,r){var n,o,i;return function(){var a,s=r(this),l;return s==null?void this.removeAttribute(t):(a=this.getAttribute(t),l=s+"",a===l?null:a===n&&l===o?i:(o=l,i=e(n=a,s)))}}function Zs(t,e,r){var n,o,i;return function(){var a,s=r(this),l;return s==null?void this.removeAttributeNS(t.space,t.local):(a=this.getAttributeNS(t.space,t.local),l=s+"",a===l?null:a===n&&l===o?i:(o=l,i=e(n=a,s)))}}function Bo(t,e){var r=ft(t),n=r==="transform"?Er:Xe;return this.attrTween(t,typeof e=="function"?(r.local?Zs:Ws)(r,n,Dt(this,"attr."+t,e)):e==null?(r.local?Vs:Ys)(r):(r.local?Us:Xs)(r,n,e))}function Ks(t,e){return function(r){this.setAttribute(t,e.call(this,r))}}function Qs(t,e){return function(r){this.setAttributeNS(t.space,t.local,e.call(this,r))}}function js(t,e){var r,n;function o(){var i=e.apply(this,arguments);return i!==n&&(r=(n=i)&&Qs(t,i)),r}return o._value=e,o}function Js(t,e){var r,n;function o(){var i=e.apply(this,arguments);return i!==n&&(r=(n=i)&&Ks(t,i)),r}return o._value=e,o}function Ro(t,e){var r="attr."+t;if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;var n=ft(t);return this.tween(r,(n.local?js:Js)(n,e))}function tu(t,e){return function(){ce(this,t).delay=+e.apply(this,arguments)}}function eu(t,e){return e=+e,function(){ce(this,t).delay=e}}function To(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?tu:eu)(e,t)):q(this.node(),e).delay}function ru(t,e){return function(){X(this,t).duration=+e.apply(this,arguments)}}function nu(t,e){return e=+e,function(){X(this,t).duration=e}}function Io(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?ru:nu)(e,t)):q(this.node(),e).duration}function ou(t,e){if(typeof e!="function")throw new Error;return function(){X(this,t).ease=e}}function Oo(t){var e=this._id;return arguments.length?this.each(ou(e,t)):q(this.node(),e).ease}function iu(t,e){return function(){var r=e.apply(this,arguments);if(typeof r!="function")throw new Error;X(this,t).ease=r}}function Lo(t){if(typeof t!="function")throw new Error;return this.each(iu(this._id,t))}function zo(t){typeof t!="function"&&(t=Kt(t));for(var e=this._groups,r=e.length,n=new Array(r),o=0;o<r;++o)for(var i=e[o],a=i.length,s=n[o]=[],l,u=0;u<a;++u)(l=i[u])&&t.call(l,l.__data__,u,i)&&s.push(l);return new U(n,this._parents,this._name,this._id)}function $o(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,r=t._groups,n=e.length,o=r.length,i=Math.min(n,o),a=new Array(n),s=0;s<i;++s)for(var l=e[s],u=r[s],m=l.length,h=a[s]=new Array(m),f,c=0;c<m;++c)(f=l[c]||u[c])&&(h[c]=f);for(;s<n;++s)a[s]=e[s];return new U(a,this._parents,this._name,this._id)}function au(t){return(t+"").trim().split(/^|\s+/).every(function(e){var r=e.indexOf(".");return r>=0&&(e=e.slice(0,r)),!e||e==="start"})}function su(t,e,r){var n,o,i=au(e)?ce:X;return function(){var a=i(this,t),s=a.on;s!==n&&(o=(n=s).copy()).on(e,r),a.on=o}}function Fo(t,e){var r=this._id;return arguments.length<2?q(this.node(),r).on.on(t):this.each(su(r,t,e))}function uu(t){return function(){var e=this.parentNode;for(var r in this.__transition)if(+r!==t)return;e&&e.removeChild(this)}}function qo(){return this.on("end.remove",uu(this._id))}function Do(t){var e=this._name,r=this._id;typeof t!="function"&&(t=Mt(t));for(var n=this._groups,o=n.length,i=new Array(o),a=0;a<o;++a)for(var s=n[a],l=s.length,u=i[a]=new Array(l),m,h,f=0;f<l;++f)(m=s[f])&&(h=t.call(m,m.__data__,f,s))&&("__data__"in m&&(h.__data__=m.__data__),u[f]=h,yt(u[f],e,r,f,u,q(m,r)));return new U(i,this._parents,e,r)}function Ho(t){var e=this._name,r=this._id;typeof t!="function"&&(t=Zt(t));for(var n=this._groups,o=n.length,i=[],a=[],s=0;s<o;++s)for(var l=n[s],u=l.length,m,h=0;h<u;++h)if(m=l[h]){for(var f=t.call(m,m.__data__,h,l),c,g=q(m,r),p=0,d=f.length;p<d;++p)(c=f[p])&&yt(c,e,r,p,f,g);i.push(f),a.push(m)}return new U(i,a,e,r)}var lu=ct.prototype.constructor;function Go(){return new lu(this._groups,this._parents)}function fu(t,e){var r,n,o;return function(){var i=xt(this,t),a=(this.style.removeProperty(t),xt(this,t));return i===a?null:i===r&&a===n?o:o=e(r=i,n=a)}}function Yo(t){return function(){this.style.removeProperty(t)}}function cu(t,e,r){var n,o=r+"",i;return function(){var a=xt(this,t);return a===o?null:a===n?i:i=e(n=a,r)}}function mu(t,e,r){var n,o,i;return function(){var a=xt(this,t),s=r(this),l=s+"";return s==null&&(l=s=(this.style.removeProperty(t),xt(this,t))),a===l?null:a===n&&l===o?i:(o=l,i=e(n=a,s))}}function hu(t,e){var r,n,o,i="style."+e,a="end."+i,s;return function(){var l=X(this,t),u=l.on,m=l.value[i]==null?s||(s=Yo(e)):void 0;(u!==r||o!==m)&&(n=(r=u).copy()).on(a,o=m),l.on=n}}function Vo(t,e,r){var n=(t+="")=="transform"?Mr:Xe;return e==null?this.styleTween(t,fu(t,n)).on("end.style."+t,Yo(t)):typeof e=="function"?this.styleTween(t,mu(t,n,Dt(this,"style."+t,e))).each(hu(this._id,t)):this.styleTween(t,cu(t,n,e),r).on("end.style."+t,null)}function pu(t,e,r){return function(n){this.style.setProperty(t,e.call(this,n),r)}}function du(t,e,r){var n,o;function i(){var a=e.apply(this,arguments);return a!==o&&(n=(o=a)&&pu(t,a,r)),n}return i._value=e,i}function Xo(t,e,r){var n="style."+(t+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;return this.tween(n,du(t,e,r==null?"":r))}function gu(t){return function(){this.textContent=t}}function xu(t){return function(){var e=t(this);this.textContent=e==null?"":e}}function Uo(t){return this.tween("text",typeof t=="function"?xu(Dt(this,"text",t)):gu(t==null?"":t+""))}function yu(t){return function(e){this.textContent=t.call(this,e)}}function bu(t){var e,r;function n(){var o=t.apply(this,arguments);return o!==r&&(e=(r=o)&&yu(o)),e}return n._value=t,n}function Wo(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,bu(t))}function Zo(){for(var t=this._name,e=this._id,r=Ue(),n=this._groups,o=n.length,i=0;i<o;++i)for(var a=n[i],s=a.length,l,u=0;u<s;++u)if(l=a[u]){var m=q(l,e);yt(l,t,r,u,a,{time:m.time+m.delay+m.duration,delay:0,duration:m.duration,ease:m.ease})}return new U(n,this._parents,t,r)}function Ko(){var t,e,r=this,n=r._id,o=r.size();return new Promise(function(i,a){var s={value:a},l={value:function(){--o===0&&i()}};r.each(function(){var u=X(this,n),m=u.on;m!==t&&(e=(t=m).copy(),e._.cancel.push(s),e._.interrupt.push(s),e._.end.push(l)),u.on=e}),o===0&&i()})}var vu=0;function U(t,e,r,n){this._groups=t,this._parents=e,this._name=r,this._id=n}function Qo(t){return ct().transition(t)}function Ue(){return++vu}var mt=ct.prototype;U.prototype=Qo.prototype={constructor:U,select:Do,selectAll:Ho,selectChild:mt.selectChild,selectChildren:mt.selectChildren,filter:zo,merge:$o,selection:Go,transition:Zo,call:mt.call,nodes:mt.nodes,node:mt.node,size:mt.size,empty:mt.empty,each:mt.each,on:Fo,attr:Bo,attrTween:Ro,style:Vo,styleTween:Xo,text:Uo,textTween:Wo,remove:qo,tween:Co,delay:To,duration:Io,ease:Oo,easeVarying:Lo,end:Ko,[Symbol.iterator]:mt[Symbol.iterator]};function We(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var wu={time:null,delay:0,duration:250,ease:We};function _u(t,e){for(var r;!(r=t.__transition)||!(r=r[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return r}function jo(t){var e,r;t instanceof U?(e=t._id,t=t._name):(e=Ue(),(r=wu).time=le(),t=t==null?null:t+"");for(var n=this._groups,o=n.length,i=0;i<o;++i)for(var a=n[i],s=a.length,l,u=0;u<s;++u)(l=a[u])&&yt(l,t,e,u,a,r||_u(l,e));return new U(n,this._parents,t,e)}ct.prototype.interrupt=No;ct.prototype.transition=jo;var{abs:Rd,max:Td,min:Id}=Math;function Jo(t){return[+t[0],+t[1]]}function Su(t){return[Jo(t[0]),Jo(t[1])]}var Od={name:"x",handles:["w","e"].map(Pr),input:function(t,e){return t==null?null:[[+t[0],e[0][1]],[+t[1],e[1][1]]]},output:function(t){return t&&[t[0][0],t[1][0]]}},Ld={name:"y",handles:["n","s"].map(Pr),input:function(t,e){return t==null?null:[[e[0][0],+t[0]],[e[1][0],+t[1]]]},output:function(t){return t&&[t[0][1],t[1][1]]}},zd={name:"xy",handles:["n","w","e","s","nw","ne","sw","se"].map(Pr),input:function(t){return t==null?null:Su(t)},output:function(t){return t}};function Pr(t){return{type:t}}function Nr(t,e){var r,n=1;t==null&&(t=0),e==null&&(e=0);function o(){var i,a=r.length,s,l=0,u=0;for(i=0;i<a;++i)s=r[i],l+=s.x,u+=s.y;for(l=(l/a-t)*n,u=(u/a-e)*n,i=0;i<a;++i)s=r[i],s.x-=l,s.y-=u}return o.initialize=function(i){r=i},o.x=function(i){return arguments.length?(t=+i,o):t},o.y=function(i){return arguments.length?(e=+i,o):e},o.strength=function(i){return arguments.length?(n=+i,o):n},o}function ti(t){let e=+this._x.call(null,t),r=+this._y.call(null,t);return ei(this.cover(e,r),e,r,t)}function ei(t,e,r,n){if(isNaN(e)||isNaN(r))return t;var o,i=t._root,a={data:n},s=t._x0,l=t._y0,u=t._x1,m=t._y1,h,f,c,g,p,d,y,x;if(!i)return t._root=a,t;for(;i.length;)if((p=e>=(h=(s+u)/2))?s=h:u=h,(d=r>=(f=(l+m)/2))?l=f:m=f,o=i,!(i=i[y=d<<1|p]))return o[y]=a,t;if(c=+t._x.call(null,i.data),g=+t._y.call(null,i.data),e===c&&r===g)return a.next=i,o?o[y]=a:t._root=a,t;do o=o?o[y]=new Array(4):t._root=new Array(4),(p=e>=(h=(s+u)/2))?s=h:u=h,(d=r>=(f=(l+m)/2))?l=f:m=f;while((y=d<<1|p)===(x=(g>=f)<<1|c>=h));return o[x]=i,o[y]=a,t}function ri(t){var e,r,n=t.length,o,i,a=new Array(n),s=new Array(n),l=1/0,u=1/0,m=-1/0,h=-1/0;for(r=0;r<n;++r)isNaN(o=+this._x.call(null,e=t[r]))||isNaN(i=+this._y.call(null,e))||(a[r]=o,s[r]=i,o<l&&(l=o),o>m&&(m=o),i<u&&(u=i),i>h&&(h=i));if(l>m||u>h)return this;for(this.cover(l,u).cover(m,h),r=0;r<n;++r)ei(this,a[r],s[r],t[r]);return this}function ni(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var r=this._x0,n=this._y0,o=this._x1,i=this._y1;if(isNaN(r))o=(r=Math.floor(t))+1,i=(n=Math.floor(e))+1;else{for(var a=o-r||1,s=this._root,l,u;r>t||t>=o||n>e||e>=i;)switch(u=(e<n)<<1|t<r,l=new Array(4),l[u]=s,s=l,a*=2,u){case 0:o=r+a,i=n+a;break;case 1:r=o-a,i=n+a;break;case 2:o=r+a,n=i-a;break;case 3:r=o-a,n=i-a;break}this._root&&this._root.length&&(this._root=s)}return this._x0=r,this._y0=n,this._x1=o,this._y1=i,this}function oi(){var t=[];return this.visit(function(e){if(!e.length)do t.push(e.data);while(e=e.next)}),t}function ii(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function H(t,e,r,n,o){this.node=t,this.x0=e,this.y0=r,this.x1=n,this.y1=o}function ai(t,e,r){var n,o=this._x0,i=this._y0,a,s,l,u,m=this._x1,h=this._y1,f=[],c=this._root,g,p;for(c&&f.push(new H(c,o,i,m,h)),r==null?r=1/0:(o=t-r,i=e-r,m=t+r,h=e+r,r*=r);g=f.pop();)if(!(!(c=g.node)||(a=g.x0)>m||(s=g.y0)>h||(l=g.x1)<o||(u=g.y1)<i))if(c.length){var d=(a+l)/2,y=(s+u)/2;f.push(new H(c[3],d,y,l,u),new H(c[2],a,y,d,u),new H(c[1],d,s,l,y),new H(c[0],a,s,d,y)),(p=(e>=y)<<1|t>=d)&&(g=f[f.length-1],f[f.length-1]=f[f.length-1-p],f[f.length-1-p]=g)}else{var x=t-+this._x.call(null,c.data),b=e-+this._y.call(null,c.data),v=x*x+b*b;if(v<r){var w=Math.sqrt(r=v);o=t-w,i=e-w,m=t+w,h=e+w,n=c.data}}return n}function si(t){if(isNaN(m=+this._x.call(null,t))||isNaN(h=+this._y.call(null,t)))return this;var e,r=this._root,n,o,i,a=this._x0,s=this._y0,l=this._x1,u=this._y1,m,h,f,c,g,p,d,y;if(!r)return this;if(r.length)for(;;){if((g=m>=(f=(a+l)/2))?a=f:l=f,(p=h>=(c=(s+u)/2))?s=c:u=c,e=r,!(r=r[d=p<<1|g]))return this;if(!r.length)break;(e[d+1&3]||e[d+2&3]||e[d+3&3])&&(n=e,y=d)}for(;r.data!==t;)if(o=r,!(r=r.next))return this;return(i=r.next)&&delete r.next,o?(i?o.next=i:delete o.next,this):e?(i?e[d]=i:delete e[d],(r=e[0]||e[1]||e[2]||e[3])&&r===(e[3]||e[2]||e[1]||e[0])&&!r.length&&(n?n[y]=r:this._root=r),this):(this._root=i,this)}function ui(t){for(var e=0,r=t.length;e<r;++e)this.remove(t[e]);return this}function li(){return this._root}function fi(){var t=0;return this.visit(function(e){if(!e.length)do++t;while(e=e.next)}),t}function ci(t){var e=[],r,n=this._root,o,i,a,s,l;for(n&&e.push(new H(n,this._x0,this._y0,this._x1,this._y1));r=e.pop();)if(!t(n=r.node,i=r.x0,a=r.y0,s=r.x1,l=r.y1)&&n.length){var u=(i+s)/2,m=(a+l)/2;(o=n[3])&&e.push(new H(o,u,m,s,l)),(o=n[2])&&e.push(new H(o,i,m,u,l)),(o=n[1])&&e.push(new H(o,u,a,s,m)),(o=n[0])&&e.push(new H(o,i,a,u,m))}return this}function mi(t){var e=[],r=[],n;for(this._root&&e.push(new H(this._root,this._x0,this._y0,this._x1,this._y1));n=e.pop();){var o=n.node;if(o.length){var i,a=n.x0,s=n.y0,l=n.x1,u=n.y1,m=(a+l)/2,h=(s+u)/2;(i=o[0])&&e.push(new H(i,a,s,m,h)),(i=o[1])&&e.push(new H(i,m,s,l,h)),(i=o[2])&&e.push(new H(i,a,h,m,u)),(i=o[3])&&e.push(new H(i,m,h,l,u))}r.push(n)}for(;n=r.pop();)t(n.node,n.x0,n.y0,n.x1,n.y1);return this}function hi(t){return t[0]}function pi(t){return arguments.length?(this._x=t,this):this._x}function di(t){return t[1]}function gi(t){return arguments.length?(this._y=t,this):this._y}function Ct(t,e,r){var n=new Cr(e==null?hi:e,r==null?di:r,NaN,NaN,NaN,NaN);return t==null?n:n.addAll(t)}function Cr(t,e,r,n,o,i){this._x=t,this._y=e,this._x0=r,this._y0=n,this._x1=o,this._y1=i,this._root=void 0}function xi(t){for(var e={data:t.data},r=e;t=t.next;)r=r.next={data:t.data};return e}var W=Ct.prototype=Cr.prototype;W.copy=function(){var t=new Cr(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root,r,n;if(!e)return t;if(!e.length)return t._root=xi(e),t;for(r=[{source:e,target:t._root=new Array(4)}];e=r.pop();)for(var o=0;o<4;++o)(n=e.source[o])&&(n.length?r.push({source:n,target:e.target[o]=new Array(4)}):e.target[o]=xi(n));return t};W.add=ti;W.addAll=ri;W.cover=ni;W.data=oi;W.extent=ii;W.find=ai;W.remove=si;W.removeAll=ui;W.root=li;W.size=fi;W.visit=ci;W.visitAfter=mi;W.x=pi;W.y=gi;function ut(t){return function(){return t}}function it(t){return(t()-.5)*1e-6}function Au(t){return t.x+t.vx}function Mu(t){return t.y+t.vy}function Br(t){var e,r,n,o=1,i=1;typeof t!="function"&&(t=ut(t==null?1:+t));function a(){for(var u,m=e.length,h,f,c,g,p,d,y=0;y<i;++y)for(h=Ct(e,Au,Mu).visitAfter(s),u=0;u<m;++u)f=e[u],p=r[f.index],d=p*p,c=f.x+f.vx,g=f.y+f.vy,h.visit(x);function x(b,v,w,E,P){var N=b.data,O=b.r,M=p+O;if(N){if(N.index>f.index){var _=c-N.x-N.vx,B=g-N.y-N.vy,C=_*_+B*B;C<M*M&&(_===0&&(_=it(n),C+=_*_),B===0&&(B=it(n),C+=B*B),C=(M-(C=Math.sqrt(C)))/C*o,f.vx+=(_*=C)*(M=(O*=O)/(d+O)),f.vy+=(B*=C)*M,N.vx-=_*(M=1-M),N.vy-=B*M)}return}return v>c+M||E<c-M||w>g+M||P<g-M}}function s(u){if(u.data)return u.r=r[u.data.index];for(var m=u.r=0;m<4;++m)u[m]&&u[m].r>u.r&&(u.r=u[m].r)}function l(){if(e){var u,m=e.length,h;for(r=new Array(m),u=0;u<m;++u)h=e[u],r[h.index]=+t(h,u,e)}}return a.initialize=function(u,m){e=u,n=m,l()},a.iterations=function(u){return arguments.length?(i=+u,a):i},a.strength=function(u){return arguments.length?(o=+u,a):o},a.radius=function(u){return arguments.length?(t=typeof u=="function"?u:ut(+u),l(),a):t},a}function Eu(t){return t.index}function yi(t,e){var r=t.get(e);if(!r)throw new Error("node not found: "+e);return r}function Rr(t){var e=Eu,r=h,n,o=ut(30),i,a,s,l,u,m=1;t==null&&(t=[]);function h(d){return 1/Math.min(s[d.source.index],s[d.target.index])}function f(d){for(var y=0,x=t.length;y<m;++y)for(var b=0,v,w,E,P,N,O,M;b<x;++b)v=t[b],w=v.source,E=v.target,P=E.x+E.vx-w.x-w.vx||it(u),N=E.y+E.vy-w.y-w.vy||it(u),O=Math.sqrt(P*P+N*N),O=(O-i[b])/O*d*n[b],P*=O,N*=O,E.vx-=P*(M=l[b]),E.vy-=N*M,w.vx+=P*(M=1-M),w.vy+=N*M}function c(){if(a){var d,y=a.length,x=t.length,b=new Map(a.map((w,E)=>[e(w,E,a),w])),v;for(d=0,s=new Array(y);d<x;++d)v=t[d],v.index=d,typeof v.source!="object"&&(v.source=yi(b,v.source)),typeof v.target!="object"&&(v.target=yi(b,v.target)),s[v.source.index]=(s[v.source.index]||0)+1,s[v.target.index]=(s[v.target.index]||0)+1;for(d=0,l=new Array(x);d<x;++d)v=t[d],l[d]=s[v.source.index]/(s[v.source.index]+s[v.target.index]);n=new Array(x),g(),i=new Array(x),p()}}function g(){if(a)for(var d=0,y=t.length;d<y;++d)n[d]=+r(t[d],d,t)}function p(){if(a)for(var d=0,y=t.length;d<y;++d)i[d]=+o(t[d],d,t)}return f.initialize=function(d,y){a=d,u=y,c()},f.links=function(d){return arguments.length?(t=d,c(),f):t},f.id=function(d){return arguments.length?(e=d,f):e},f.iterations=function(d){return arguments.length?(m=+d,f):m},f.strength=function(d){return arguments.length?(r=typeof d=="function"?d:ut(+d),g(),f):r},f.distance=function(d){return arguments.length?(o=typeof d=="function"?d:ut(+d),p(),f):o},f}function bi(){let t=1;return()=>(t=(1664525*t+1013904223)%4294967296)/4294967296}function vi(t){return t.x}function wi(t){return t.y}var ku=10,Pu=Math.PI*(3-Math.sqrt(5));function Tr(t){var e,r=1,n=.001,o=1-Math.pow(n,1/300),i=0,a=.6,s=new Map,l=qt(h),u=Wt("tick","end"),m=bi();t==null&&(t=[]);function h(){f(),u.call("tick",e),r<n&&(l.stop(),u.call("end",e))}function f(p){var d,y=t.length,x;p===void 0&&(p=1);for(var b=0;b<p;++b)for(r+=(i-r)*o,s.forEach(function(v){v(r)}),d=0;d<y;++d)x=t[d],x.fx==null?x.x+=x.vx*=a:(x.x=x.fx,x.vx=0),x.fy==null?x.y+=x.vy*=a:(x.y=x.fy,x.vy=0);return e}function c(){for(var p=0,d=t.length,y;p<d;++p){if(y=t[p],y.index=p,y.fx!=null&&(y.x=y.fx),y.fy!=null&&(y.y=y.fy),isNaN(y.x)||isNaN(y.y)){var x=ku*Math.sqrt(.5+p),b=p*Pu;y.x=x*Math.cos(b),y.y=x*Math.sin(b)}(isNaN(y.vx)||isNaN(y.vy))&&(y.vx=y.vy=0)}}function g(p){return p.initialize&&p.initialize(t,m),p}return c(),e={tick:f,restart:function(){return l.restart(h),e},stop:function(){return l.stop(),e},nodes:function(p){return arguments.length?(t=p,c(),s.forEach(g),e):t},alpha:function(p){return arguments.length?(r=+p,e):r},alphaMin:function(p){return arguments.length?(n=+p,e):n},alphaDecay:function(p){return arguments.length?(o=+p,e):+o},alphaTarget:function(p){return arguments.length?(i=+p,e):i},velocityDecay:function(p){return arguments.length?(a=1-p,e):1-a},randomSource:function(p){return arguments.length?(m=p,s.forEach(g),e):m},force:function(p,d){return arguments.length>1?(d==null?s.delete(p):s.set(p,g(d)),e):s.get(p)},find:function(p,d,y){var x=0,b=t.length,v,w,E,P,N;for(y==null?y=1/0:y*=y,x=0;x<b;++x)P=t[x],v=p-P.x,w=d-P.y,E=v*v+w*w,E<y&&(N=P,y=E);return N},on:function(p,d){return arguments.length>1?(u.on(p,d),e):u.on(p)}}}function Ir(){var t,e,r,n,o=ut(-30),i,a=1,s=1/0,l=.81;function u(c){var g,p=t.length,d=Ct(t,vi,wi).visitAfter(h);for(n=c,g=0;g<p;++g)e=t[g],d.visit(f)}function m(){if(t){var c,g=t.length,p;for(i=new Array(g),c=0;c<g;++c)p=t[c],i[p.index]=+o(p,c,t)}}function h(c){var g=0,p,d,y=0,x,b,v;if(c.length){for(x=b=v=0;v<4;++v)(p=c[v])&&(d=Math.abs(p.value))&&(g+=p.value,y+=d,x+=d*p.x,b+=d*p.y);c.x=x/y,c.y=b/y}else{p=c,p.x=p.data.x,p.y=p.data.y;do g+=i[p.data.index];while(p=p.next)}c.value=g}function f(c,g,p,d){if(!c.value)return!0;var y=c.x-e.x,x=c.y-e.y,b=d-g,v=y*y+x*x;if(b*b/l<v)return v<s&&(y===0&&(y=it(r),v+=y*y),x===0&&(x=it(r),v+=x*x),v<a&&(v=Math.sqrt(a*v)),e.vx+=y*c.value*n/v,e.vy+=x*c.value*n/v),!0;if(c.length||v>=s)return;(c.data!==e||c.next)&&(y===0&&(y=it(r),v+=y*y),x===0&&(x=it(r),v+=x*x),v<a&&(v=Math.sqrt(a*v)));do c.data!==e&&(b=i[c.data.index]*n/v,e.vx+=y*b,e.vy+=x*b);while(c=c.next)}return u.initialize=function(c,g){t=c,r=g,m()},u.strength=function(c){return arguments.length?(o=typeof c=="function"?c:ut(+c),m(),u):o},u.distanceMin=function(c){return arguments.length?(a=c*c,u):Math.sqrt(a)},u.distanceMax=function(c){return arguments.length?(s=c*c,u):Math.sqrt(s)},u.theta=function(c){return arguments.length?(l=c*c,u):Math.sqrt(l)},u}function _i(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function Bt(t,e){if((r=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var r,n=t.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+t.slice(r+1)]}function lt(t){return t=Bt(Math.abs(t)),t?t[1]:NaN}function Si(t,e){return function(r,n){for(var o=r.length,i=[],a=0,s=t[0],l=0;o>0&&s>0&&(l+s+1>n&&(s=Math.max(1,n-l)),i.push(r.substring(o-=s,o+s)),!((l+=s+1)>n));)s=t[a=(a+1)%t.length];return i.reverse().join(e)}}function Ai(t){return function(e){return e.replace(/[0-9]/g,function(r){return t[+r]})}}var Nu=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function bt(t){if(!(e=Nu.exec(t)))throw new Error("invalid format: "+t);var e;return new Ze({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}bt.prototype=Ze.prototype;function Ze(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}Ze.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Mi(t){t:for(var e=t.length,r=1,n=-1,o;r<e;++r)switch(t[r]){case".":n=o=r;break;case"0":n===0&&(n=r),o=r;break;default:if(!+t[r])break t;n>0&&(n=0);break}return n>0?t.slice(0,n)+t.slice(o+1):t}var Or;function Ei(t,e){var r=Bt(t,e);if(!r)return t+"";var n=r[0],o=r[1],i=o-(Or=Math.max(-8,Math.min(8,Math.floor(o/3)))*3)+1,a=n.length;return i===a?n:i>a?n+new Array(i-a+1).join("0"):i>0?n.slice(0,i)+"."+n.slice(i):"0."+new Array(1-i).join("0")+Bt(t,Math.max(0,e+i-1))[0]}function Lr(t,e){var r=Bt(t,e);if(!r)return t+"";var n=r[0],o=r[1];return o<0?"0."+new Array(-o).join("0")+n:n.length>o+1?n.slice(0,o+1)+"."+n.slice(o+1):n+new Array(o-n.length+2).join("0")}var zr={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:_i,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>Lr(t*100,e),r:Lr,s:Ei,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function $r(t){return t}var ki=Array.prototype.map,Pi=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function Ni(t){var e=t.grouping===void 0||t.thousands===void 0?$r:Si(ki.call(t.grouping,Number),t.thousands+""),r=t.currency===void 0?"":t.currency[0]+"",n=t.currency===void 0?"":t.currency[1]+"",o=t.decimal===void 0?".":t.decimal+"",i=t.numerals===void 0?$r:Ai(ki.call(t.numerals,String)),a=t.percent===void 0?"%":t.percent+"",s=t.minus===void 0?"\u2212":t.minus+"",l=t.nan===void 0?"NaN":t.nan+"";function u(h){h=bt(h);var f=h.fill,c=h.align,g=h.sign,p=h.symbol,d=h.zero,y=h.width,x=h.comma,b=h.precision,v=h.trim,w=h.type;w==="n"?(x=!0,w="g"):zr[w]||(b===void 0&&(b=12),v=!0,w="g"),(d||f==="0"&&c==="=")&&(d=!0,f="0",c="=");var E=p==="$"?r:p==="#"&&/[boxX]/.test(w)?"0"+w.toLowerCase():"",P=p==="$"?n:/[%p]/.test(w)?a:"",N=zr[w],O=/[defgprs%]/.test(w);b=b===void 0?6:/[gprs]/.test(w)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b));function M(_){var B=E,C=P,D,et,G;if(w==="c")C=N(_)+C,_="";else{_=+_;var Z=_<0||1/_<0;if(_=isNaN(_)?l:N(Math.abs(_),b),v&&(_=Mi(_)),Z&&+_==0&&g!=="+"&&(Z=!1),B=(Z?g==="("?g:s:g==="-"||g==="("?"":g)+B,C=(w==="s"?Pi[8+Or/3]:"")+C+(Z&&g==="("?")":""),O){for(D=-1,et=_.length;++D<et;)if(G=_.charCodeAt(D),48>G||G>57){C=(G===46?o+_.slice(D+1):_.slice(D))+C,_=_.slice(0,D);break}}}x&&!d&&(_=e(_,1/0));var J=B.length+_.length+C.length,Y=J<y?new Array(y-J+1).join(f):"";switch(x&&d&&(_=e(Y+_,Y.length?y-C.length:1/0),Y=""),c){case"<":_=B+_+C+Y;break;case"=":_=B+Y+_+C;break;case"^":_=Y.slice(0,J=Y.length>>1)+B+_+C+Y.slice(J);break;default:_=Y+B+_+C;break}return i(_)}return M.toString=function(){return h+""},M}function m(h,f){var c=u((h=bt(h),h.type="f",h)),g=Math.max(-8,Math.min(8,Math.floor(lt(f)/3)))*3,p=Math.pow(10,-g),d=Pi[8+g/3];return function(y){return c(p*y)+d}}return{format:u,formatPrefix:m}}var Ke,Qe,je;Fr({thousands:",",grouping:[3],currency:["$",""]});function Fr(t){return Ke=Ni(t),Qe=Ke.format,je=Ke.formatPrefix,Ke}function qr(t){return Math.max(0,-lt(Math.abs(t)))}function Dr(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(lt(e)/3)))*3-lt(Math.abs(t)))}function Hr(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,lt(e)-lt(t))+1}function Ci(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function Bi(t,e){switch(arguments.length){case 0:break;case 1:{typeof t=="function"?this.interpolator(t):this.range(t);break}default:{this.domain(t),typeof e=="function"?this.interpolator(e):this.range(e);break}}return this}function Gr(t){return function(){return t}}function Yr(t){return+t}var Ri=[0,1];function ht(t){return t}function Vr(t,e){return(e-=t=+t)?function(r){return(r-t)/e}:Gr(isNaN(e)?NaN:.5)}function Cu(t,e){var r;return t>e&&(r=t,t=e,e=r),function(n){return Math.max(t,Math.min(e,n))}}function Bu(t,e,r){var n=t[0],o=t[1],i=e[0],a=e[1];return o<n?(n=Vr(o,n),i=r(a,i)):(n=Vr(n,o),i=r(i,a)),function(s){return i(n(s))}}function Ru(t,e,r){var n=Math.min(t.length,e.length)-1,o=new Array(n),i=new Array(n),a=-1;for(t[n]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++a<n;)o[a]=Vr(t[a],t[a+1]),i[a]=r(e[a],e[a+1]);return function(s){var l=Yt(t,s,1,n)-1;return i[l](o[l](s))}}function Ti(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function Tu(){var t=Ri,e=Ri,r=ot,n,o,i,a=ht,s,l,u;function m(){var f=Math.min(t.length,e.length);return a!==ht&&(a=Cu(t[0],t[f-1])),s=f>2?Ru:Bu,l=u=null,h}function h(f){return f==null||isNaN(f=+f)?i:(l||(l=s(t.map(n),e,r)))(n(a(f)))}return h.invert=function(f){return a(o((u||(u=s(e,t.map(n),V)))(f)))},h.domain=function(f){return arguments.length?(t=Array.from(f,Yr),m()):t.slice()},h.range=function(f){return arguments.length?(e=Array.from(f),m()):e.slice()},h.rangeRound=function(f){return e=Array.from(f),r=ne,m()},h.clamp=function(f){return arguments.length?(a=f?!0:ht,m()):a!==ht},h.interpolate=function(f){return arguments.length?(r=f,m()):r},h.unknown=function(f){return arguments.length?(i=f,h):i},function(f,c){return n=f,o=c,m()}}function Xr(){return Tu()(ht,ht)}function Ur(t,e,r,n){var o=sr(t,e,r),i;switch(n=bt(n==null?",f":n),n.type){case"s":{var a=Math.max(Math.abs(t),Math.abs(e));return n.precision==null&&!isNaN(i=Dr(o,a))&&(n.precision=i),je(n,a)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(i=Hr(o,Math.max(Math.abs(t),Math.abs(e))))&&(n.precision=i-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(i=qr(o))&&(n.precision=i-(n.type==="%")*2);break}}return Qe(n)}function Wr(t){var e=t.domain;return t.ticks=function(r){var n=e();return Ot(n[0],n[n.length-1],r==null?10:r)},t.tickFormat=function(r,n){var o=e();return Ur(o[0],o[o.length-1],r==null?10:r,n)},t.nice=function(r){r==null&&(r=10);var n=e(),o=0,i=n.length-1,a=n[o],s=n[i],l,u,m=10;for(s<a&&(u=a,a=s,s=u,u=o,o=i,i=u);m-- >0;){if(u=at(a,s,r),u===l)return n[o]=a,n[i]=s,e(n);if(u>0)a=Math.floor(a/u)*u,s=Math.ceil(s/u)*u;else if(u<0)a=Math.ceil(a*u)/u,s=Math.floor(s*u)/u;else break;l=u}return t},t}function vt(){var t=Xr();return t.copy=function(){return Ti(t,vt())},Ci.apply(t,arguments),Wr(t)}function Ii(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function Iu(){var t=0,e=.5,r=1,n=1,o,i,a,s,l,u=ht,m,h=!1,f;function c(p){return isNaN(p=+p)?f:(p=.5+((p=+m(p))-i)*(n*p<n*i?s:l),u(h?Math.max(0,Math.min(1,p)):p))}c.domain=function(p){return arguments.length?([t,e,r]=p,o=m(t=+t),i=m(e=+e),a=m(r=+r),s=o===i?0:.5/(i-o),l=i===a?0:.5/(a-i),n=i<o?-1:1,c):[t,e,r]},c.clamp=function(p){return arguments.length?(h=!!p,c):h},c.interpolator=function(p){return arguments.length?(u=p,c):u};function g(p){return function(d){var y,x,b;return arguments.length?([y,x,b]=d,u=ze(p,[y,x,b]),c):[u(0),u(.5),u(1)]}}return c.range=g(ot),c.rangeRound=g(ne),c.unknown=function(p){return arguments.length?(f=p,c):f},function(p){return m=p,o=p(t),i=p(e),a=p(r),s=o===i?0:.5/(i-o),l=i===a?0:.5/(a-i),n=i<o?-1:1,c}}function me(){var t=Wr(Iu()(ht));return t.copy=function(){return Ii(t,me())},Bi.apply(t,arguments)}function Oi(t){for(var e=t.length/6|0,r=new Array(e),n=0;n<e;)r[n]="#"+t.slice(n*6,++n*6);return r}var Li=t=>wr(t[t.length-1]);var zi=new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(Oi),Zr=Li(zi);function wt(t,e,r){this.k=t,this.x=e,this.y=r}wt.prototype={constructor:wt,scale:function(t){return t===1?this:new wt(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new wt(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Kr=new wt(1,0,0);Qr.prototype=wt.prototype;function Qr(t){for(;!t.__zoom;)if(!(t=t.parentNode))return Kr;return t.__zoom}function R(t,e){return t.archetypes.includes(e)}function jr(t){t.archetypes.length||(t.archetypes=ge(t))}function Fi(t){return R(t,"Creator")||R(t,"Secondary")||t.astPct>=22}function qi(t){return R(t,"Connector")||t.astPct>=16||t.impact>=8}function Di(t){return R(t,"Off-ball Shooter")||R(t,"Stretch Big")||Number.isFinite(t.threeP)&&t.threeP>=.365&&t.threePA_rate>=.3}function Hi(t){return R(t,"Rim Runner")||R(t,"Stretch Big")||R(t,"Switch Big")||R(t,"Rim Protector")}function Ou(t,e,r,n){return!Number.isFinite(r)||r===0?null:{source:t.id,target:e.id,weight:r,reasons:n}}function Rt(t,e="current"){let r=t.filter(Boolean);r.forEach(jr);let n=[],o=0,i=new Map,a=It[e];for(let u=0;u<r.length;u+=1)for(let m=u+1;m<r.length;m+=1){let h=r[u],f=r[m],c=0,g=[],p=Fi(h),d=Fi(f),y=qi(h),x=qi(f),b=Hi(h),v=Hi(f),w=Di(h),E=Di(f),P=R(h,"POA Stopper"),N=R(f,"POA Stopper"),O=R(h,"Rim Protector")||R(h,"Switch Big"),M=R(f,"Rim Protector")||R(f,"Switch Big");Math.abs(h.paceZ-f.paceZ)<.5&&(c+=2,g.push("pace fit"));let B=(R(h,"Creator")||R(h,"Secondary"))&&(R(f,"Off-ball Shooter")||R(f,"Stretch Big")),C=(R(f,"Creator")||R(f,"Secondary"))&&(R(h,"Off-ball Shooter")||R(h,"Stretch Big"));if((B||C)&&(c+=3*a.threeFactor,g.push("creator \u2192 shooter")),h.threePA_rate>.5&&f.threePA_rate>.5&&(c+=2*a.spacingBonus,g.push("spacing stack")),h.usg>28&&f.usg>28&&h.astPct<18&&f.astPct<18&&(c-=5,g.push("usage redundancy")),(b&&d||v&&p)&&(c+=2+a.postBoost*.6,g.push("inside-out game")),a.postBoost>=2&&b&&v&&(y||x||w||E)&&(c+=1+a.postBoost*.5,g.push("hi-lo threats")),(y&&(d||v||E)||x&&(p||b||w))&&(c+=1.8+a.spacingBonus*1.2+a.postBoost*.1,g.push("connector boost")),(P&&M||N&&O)&&(c+=1.5+a.handcheck*.75,g.push("defensive spine")),!R(h,"POA Stopper")&&!R(h,"Rim Protector")&&!R(f,"POA Stopper")&&!R(f,"Rim Protector")&&(c-=6,g.push("defensive gaps")),c!==0){o+=c,g.forEach(Z=>{var Y;let J=(Y=i.get(Z))!=null?Y:0;i.set(Z,J+c)});let G=Ou(h,f,c,g);G&&n.push(G)}}let s=Math.max(0,100+o),l=Array.from(i.entries()).sort((u,m)=>Math.abs(m[1])-Math.abs(u[1])).slice(0,6).map(([u,m])=>`${u} (${m>0?"+":""}${m.toFixed(1)})`);return{score:s,edges:n,reasons:l}}function Gi(t,e,r){jr(t),jr(e);let n=0,o=[];return R(t,"POA Stopper")&&R(e,"Creator")&&(n+=3+r.handcheck,o.push("POA vs Creator")),R(t,"Rim Protector")&&R(e,"Rim Runner")&&(n+=2+r.postBoost*.3,o.push("Rim protection")),R(t,"Off-ball Shooter")&&!R(e,"Switch Big")&&(n+=2*r.threeFactor,o.push("Spacing advantage")),{advantage:n,reasons:o}}function Je(t,e,r="current"){let n=Math.min(t.length,e.length),o=0,i=0,a=[],s=[],l=It[r];for(let u=0;u<n;u+=1){let m=t[u],h=e[u];if(!m||!h)continue;let f=Gi(m,h,l);f.advantage!==0&&(o+=f.advantage,a.push(`${m.name}: ${f.reasons.join(", ")}`));let c=Gi(h,m,l);c.advantage!==0&&(i+=c.advantage,s.push(`${h.name}: ${c.reasons.join(", ")}`))}return{advantageA:o,advantageB:i,reasonsA:a,reasonsB:s}}var Lu=16,zu=34;function Yi(t,e,r,n){t.replaceChildren(),t.classList.add("rumble-graph");let o=t.clientWidth||320,i=t.clientHeight||260,a=Lt(t).append("svg").attr("role","img").attr("aria-label",`${n.title} chemistry graph`).attr("viewBox",`0 0 ${o} ${i}`).attr("class","rumble-graph__svg");a.append("title").text(`${n.title} chemistry graph`);let s=Lt(t).append("div").attr("class","rumble-graph__tooltip").attr("role","status").attr("aria-live","polite").style("opacity",0),l=gt(e,x=>x.impact),u=vt().domain(l[0]===l[1]?[0,l[1]||1]:l).range([Lu,zu]),m=e.map(x=>({id:x.id,name:x.name,impact:x.impact,radius:u(x.impact)})),h=Tr(m).force("link",Rr(r).id(x=>x.id).distance(x=>x.weight>0?90:120).strength(x=>Math.min(Math.abs(x.weight)/10,1))).force("charge",Ir().strength(-180)).force("center",Nr(o/2,i/2)).force("collision",Br().radius(x=>x.radius+6)),f=a.append("g").attr("class","rumble-graph__links"),c=a.append("g").attr("class","rumble-graph__nodes"),g=me().domain([-10,0,10]).interpolator(Zr),p=f.selectAll("line").data(r).join("line").attr("class",x=>`rumble-graph__link${x.weight<0?" rumble-graph__link--negative":""}`).attr("stroke",x=>g(x.weight)).attr("stroke-width",x=>Math.max(1,Math.min(4,Math.abs(x.weight)/2))).attr("stroke-dasharray",x=>x.weight<0?"6 6":null).on("mouseenter",(x,b)=>{let v=b.reasons.join(", ");s.style("opacity",1).text(`${v||"Chemistry"}`)}).on("mouseleave",()=>{s.transition().duration(150).style("opacity",0)}),d=c.selectAll("g").data(m).join("g").attr("class","rumble-graph__node");d.append("circle").attr("r",x=>x.radius).attr("fill","var(--rumble-node-fill, #2f7bff)").attr("stroke","var(--rumble-node-stroke, #021a4a)").attr("stroke-width",2),d.append("text").attr("class","rumble-graph__label").attr("text-anchor","middle").attr("dy","0.35em").text(x=>{var b;return(b=x.name.split(" ").pop())!=null?b:x.name}),h.on("tick",()=>{p.attr("x1",x=>x.source.x).attr("y1",x=>x.source.y).attr("x2",x=>x.target.x).attr("y2",x=>x.target.y),d.attr("transform",x=>`translate(${x.x},${x.y})`)}),new ResizeObserver(()=>{let x=t.clientWidth||o,b=t.clientHeight||i;a.attr("viewBox",`0 0 ${x} ${b}`)}).observe(t)}function $u(){return Math.random()}function Vi(t){let e=0,r=0;for(;e===0;)e=t();for(;r===0;)r=t();return Math.sqrt(-2*Math.log(e))*Math.cos(2*Math.PI*r)}function Fu(t){return t.length?t.reduce((e,r)=>e+r.impact,0)/t.length:0}function qu(t){return dt(t.eraStyle)?t.eraStyle:typeof t.eraNorm=="boolean"&&t.eraNorm?"nineties":"current"}function Zi(t,e,r,n){var v,w;let o;typeof r=="number"?(o={games:r},typeof n=="boolean"?o.eraNorm=n:dt(n)&&(o.eraStyle=n)):o={...r!=null?r:{}};let i=Number.isFinite(o.games)&&o.games?Math.max(1,Math.floor(o.games)):100,a=(v=o.rng)!=null?v:$u,s=qu(o),l=(w=It[s])!=null?w:It.current,u=Rt(t,s),m=Rt(e,s),h=Je(t,e,s),f=Ui(t,e,u.score,h.advantageA,l,s),c=Ui(e,t,m.score,h.advantageB,l,s),g=[],p=0,d=0,y=0,x=0,b=l.poss/100;for(let E=0;E<i;E+=1){let P=Vi(a)*4*l.variance,N=Vi(a)*4*l.variance,O=100*b+f/2*b,M=100*b+c/2*b,_=O+P,B=M+N,C=_-B;C>=0?y+=1:x+=1,p+=_,d+=B,g.push(C)}return{teamAWins:y,teamBWins:x,avgScoreA:g.length?p/g.length:0,avgScoreB:g.length?d/g.length:0,margins:g}}function Du(t){return t.length?t.reduce((e,r)=>e+r.paceZ,0)/t.length:0}function Hu(t,e){return t.filter(r=>r.archetypes.includes(e)).length}function Xi(t){return t.filter(e=>e.archetypes.includes("Off-ball Shooter")||e.archetypes.includes("Stretch Big")||Number.isFinite(e.threeP)&&e.threeP>=.365&&e.threePA_rate>=.35).length}function Gu(t){var r,n;let e=(n=(r=t.pos)==null?void 0:r.toUpperCase())!=null?n:"";return e.includes("C")||e.includes("F")?!0:t.archetypes.some(o=>o==="Rim Runner"||o==="Stretch Big"||o==="Switch Big"||o==="Rim Protector")}function Yu(t){return t.filter(e=>Gu(e)).length}function Vu(t){return t.filter(e=>{var o,i;return((i=(o=e.pos)==null?void 0:o.toUpperCase())!=null?i:"").includes("G")&&e.archetypes.includes("Creator")}).length}function Ui(t,e,r,n,o,i){if(!t.length)return 0;let a=r-100,s=Fu(t)*6,l=Du(t)*4,u=n*(2+o.handcheck*.25),m=Xi(t),h=Xi(e),f=m*4*o.threeFactor,c=(m-h)*2.5*o.threeFactor,g=Yu(t),p=g*o.postBoost,d=g*Math.max(0,(o.orb-1)*6),y=Hu(t,"POA Stopper"),x=Vu(t),b=o.handcheck*(y*1.5-x),v=Zu(t,i,o);return a+s+l+u+f+c+p+d+b+v}var Wi=["current","nineties","pre3","oldschool"];function Xu(t){if(!t)return null;let e=t.match(/\d{4}/g);if(!e||!e.length)return null;let r=e.map(o=>Number.parseInt(o,10)).filter(o=>Number.isFinite(o));if(!r.length)return null;let n=r.reduce((o,i)=>o+i,0);return Math.round(n/r.length)}function Uu(t){return t===null?null:t>=2005?"current":t>=1990?"nineties":t>=1975?"pre3":"oldschool"}function Wu(t){return Uu(Xu(t.era))}function Zu(t,e,r){var c;let n=0,o=0,i=new Map,a=Wi.indexOf(e);if(t.forEach(g=>{var b;let p=Wu(g);if(!p)return;n+=1,i.set(p,((b=i.get(p))!=null?b:0)+1);let d=Wi.indexOf(p),y=a-d,x;y===0?x=6+r.handcheck*.5+r.postBoost*.2:y>0?x=4+y*1.25+r.handcheck*.25:x=y*.75,o+=x}),n===0)return 0;let s=o/n,u=((c=i.get(e))!=null?c:0)/n,m=u>0?Math.max(0,(u-.35)*8):0,h=i.size?Math.max(...Array.from(i.values())):0,f=h>0?Math.max(0,(h/n-.5)*5):0;return s+m+f}var Q=5;function Ki(t,e){return{id:t,name:e,slots:new Array(Q).fill(null)}}function Tt(t){return(t!=null?t:"").toString().normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim()}function Ji(t){let e=[];return t.pos&&e.push(t.pos),t.era&&e.push(t.era),e.join(" \xB7 ")}function Ku(t,e,r){let n=r.query?r.query.split(/\s+/).filter(Boolean):[];return t.filter(o=>{var i,a;if(e.has(o.id))return!1;if(n.length){let u=`${[o.name,(i=o.era)!=null?i:"",(a=o.pos)!=null?a:"",o.archetypes.join(" ")].map(f=>Tt(f)).join(" ")}`.trim(),m=Tt(o.id);if(!n.every(f=>u.includes(f)||m.includes(f)))return!1}return!(r.era&&Tt(o.era).indexOf(r.era)===-1||r.archetype&&!o.archetypes.some(l=>Tt(l).includes(r.archetype)))})}function j(t){return t.slots.filter(e=>!!e)}function Qu(t){for(let e=0;e<t.slots.length;e+=1)if(!t.slots[e])return e;return null}function ju(t){let e=document.createElement("button");e.type="button",e.className="rumble-player-option",e.dataset.playerId=t.id;let r=Ji(t)||"\u2014";return e.innerHTML=`
    <span class="rumble-player-option__name">${t.name}</span>
    <span class="rumble-player-option__meta">${r}</span>
  `,e}function Ju(t,e){let r=document.createElement("div");if(r.className="rumble-slot",r.dataset.index=String(e),!t)return r.innerHTML=`<span class="rumble-slot__placeholder">Slot ${e+1}</span>`,r;let n=Ji(t)||"\u2014";return r.innerHTML=`
    <span class="rumble-slot__name">${t.name}</span>
    <span class="rumble-slot__meta">${n}</span>
    <button type="button" class="rumble-slot__remove" aria-label="Remove ${t.name}" data-remove="${t.id}">Remove</button>
  `,r}function Qi(t){let e=new Set;for(let r of t)r&&e.add(String(r));return Array.from(e).sort((r,n)=>r.localeCompare(n))}function tl(t,e){var m,h,f;if(t.replaceChildren(),!e.length){t.textContent="Run a simulation to view the margin distribution.";return}let r=t.clientWidth||360,n=t.clientHeight||200,o=Lt(t).append("svg").attr("viewBox",`0 0 ${r} ${n}`).attr("class","rumble-histogram"),i=Xt().thresholds(12)(e),a=vt().domain([(m=we(e))!=null?m:-20,(h=Ut(e))!=null?h:20]).nice().range([32,r-16]),s=vt().domain([0,(f=Ut(i,c=>c.length))!=null?f:1]).nice().range([n-24,16]);o.append("g").attr("class","rumble-histogram__bars").selectAll("rect").data(i).join("rect").attr("x",c=>{var g;return a((g=c.x0)!=null?g:0)+1}).attr("width",c=>{var g,p;return Math.max(0,a((g=c.x1)!=null?g:0)-a((p=c.x0)!=null?p:0)-2)}).attr("y",c=>s(c.length)).attr("height",c=>s.range()[0]-s(c.length)).attr("fill","var(--rumble-bar-fill, #1f7bff)").append("title").text(c=>{var g,p;return`Margin ${(g=c.x0)==null?void 0:g.toFixed(1)} to ${(p=c.x1)==null?void 0:p.toFixed(1)}: ${c.length} games`});let u=hr(a).ticks(6);o.append("g").attr("transform",`translate(0,${n-24})`).attr("class","rumble-histogram__axis").call(u),o.append("text").attr("class","rumble-histogram__label").attr("x",r/2).attr("y",n-4).attr("text-anchor","middle").text("Margin (Team A - Team B)")}function ji(t){return`${Math.round(t*10)/10}%`}async function ta(t){let{root:e,getPlayerPool:r,presets:n={},mode:o="overlay"}=t,i=o!=="inline",a=document.createElement("div");a.className=i?"rumble-overlay":"rumble-inline";let s=Math.random().toString(36).slice(2),l=`rumble-era-style-${s}`,u=`rumble-shell-title-${s}`,m=`rumble-shell-description-${s}`,h=i?`role="dialog" aria-modal="true" aria-labelledby="${u}" aria-describedby="${m}"`:`role="region" aria-labelledby="${u}" aria-describedby="${m}"`;a.innerHTML=`
    <div class="rumble-shell" ${h}>
      <header class="rumble-shell__header">
        <div class="rumble-shell__titles">
          <span class="eyebrow rumble-shell__eyebrow">Game Simulator</span>
          <h2 id="${u}">Roster Rumble \u2014 5v5</h2>
          <p id="${m}" class="rumble-shell__description">Build two all-time lineups, compare chemistry, then run a 100-game sim.</p>
        </div>
        <button type="button" class="rumble-shell__close" aria-label="Close Roster Rumble">\xD7</button>
      </header>
      <div class="rumble-shell__body">
        <section class="rumble-team rumble-team--a" data-team="A">
          <header class="rumble-team__header">
            <h3>Team A</h3>
            <div class="rumble-team__actions">
              <button type="button" data-action="clear" data-team="A">Clear Team</button>
              <button type="button" data-action="swap">Swap Teams</button>
              <button type="button" data-action="preset" data-team="A">Load Preset</button>
            </div>
          </header>
          <div class="rumble-team__controls">
            <label>Search</label>
            <input type="search" data-rumble-search="A" placeholder="Search players" />
            <div class="rumble-team__filters">
              <select data-rumble-era="A"><option value="">All eras</option></select>
              <select data-rumble-archetype="A"><option value="">All archetypes</option></select>
            </div>
          </div>
          <div class="rumble-team__slots" data-rumble-slots="A"></div>
          <div class="rumble-team__pool" data-rumble-pool="A" role="list"></div>
          <div class="rumble-team__graph" data-rumble-graph="A" aria-label="Team A chemistry graph"></div>
        </section>
        <section class="rumble-results">
          <div class="rumble-results__controls">
            <button type="button" data-rumble-run>Simulate 100 Games</button>
            <div class="rumble-era-style">
              <label class="sr-only" for="${l}">Era Style</label>
              <select id="${l}" data-rumble-era-style aria-label="Era Style">
                <option value="current">Era Style: Current</option>
                <option value="nineties">Era Style: 90s (bullyball)</option>
                <option value="pre3">Era Style: Pre\u20133 Point Line</option>
                <option value="oldschool">Era Style: Old School</option>
              </select>
            </div>
          </div>
          <div class="rumble-results__kpis">
            <div>
              <span class="rumble-results__label">Team A Win%</span>
              <strong data-kpi="a">\u2014</strong>
            </div>
            <div>
              <span class="rumble-results__label">Team B Win%</span>
              <strong data-kpi="b">\u2014</strong>
            </div>
            <div>
              <span class="rumble-results__label">Avg Margin</span>
              <strong data-kpi="margin">\u2014</strong>
            </div>
          </div>
          <div class="rumble-results__histogram" data-rumble-hist></div>
          <div class="rumble-results__insights">
            <h4>What helps Team A?</h4>
            <ul data-insight="a"></ul>
            <h4>What hurts Team B?</h4>
            <ul data-insight="b"></ul>
            <p class="rumble-results__hint" data-insight-hint hidden></p>
          </div>
        </section>
        <section class="rumble-team rumble-team--b" data-team="B">
          <header class="rumble-team__header">
            <h3>Team B</h3>
            <div class="rumble-team__actions">
              <button type="button" data-action="clear" data-team="B">Clear Team</button>
              <button type="button" data-action="swap">Swap Teams</button>
              <button type="button" data-action="preset" data-team="B">Load Preset</button>
            </div>
          </header>
          <div class="rumble-team__controls">
            <label>Search</label>
            <input type="search" data-rumble-search="B" placeholder="Search players" />
            <div class="rumble-team__filters">
              <select data-rumble-era="B"><option value="">All eras</option></select>
              <select data-rumble-archetype="B"><option value="">All archetypes</option></select>
            </div>
          </div>
          <div class="rumble-team__slots" data-rumble-slots="B"></div>
          <div class="rumble-team__pool" data-rumble-pool="B" role="list"></div>
          <div class="rumble-team__graph" data-rumble-graph="B" aria-label="Team B chemistry graph"></div>
        </section>
      </div>
      <footer class="rumble-shell__footer">Pick five for each side to unlock the sim.</footer>
    </div>
  `,i?e.appendChild(a):(e.replaceChildren(a),a.classList.add("is-ready","is-open"));let f=a.querySelector(".rumble-shell__close"),c=a.querySelector("[data-rumble-run]"),g=a.querySelector("[data-rumble-era-style]"),p=a.querySelector("[data-rumble-hist]"),d=a.querySelector("[data-insight='a']"),y=a.querySelector("[data-insight='b']"),x=a.querySelector("[data-insight-hint]");if(!f||!c||!g||!p||!d||!y||!x)throw new Error("Failed to initialize Roster Rumble UI");let b="current";g.value=b,i||(f.setAttribute("tabindex","-1"),f.setAttribute("aria-hidden","true"));let v={A:{slots:a.querySelector("[data-rumble-slots='A']"),pool:a.querySelector("[data-rumble-pool='A']"),graph:a.querySelector("[data-rumble-graph='A']"),search:a.querySelector("[data-rumble-search='A']"),era:a.querySelector("[data-rumble-era='A']"),archetype:a.querySelector("[data-rumble-archetype='A']")},B:{slots:a.querySelector("[data-rumble-slots='B']"),pool:a.querySelector("[data-rumble-pool='B']"),graph:a.querySelector("[data-rumble-graph='B']"),search:a.querySelector("[data-rumble-search='B']"),era:a.querySelector("[data-rumble-era='B']"),archetype:a.querySelector("[data-rumble-archetype='B']")}};if(!v.A.slots||!v.A.pool||!v.A.graph||!v.B.slots||!v.B.pool||!v.B.graph)throw new Error("Missing team containers");let w={A:Ki("A","Team A"),B:Ki("B","Team B")},E={A:{query:"",era:"",archetype:""},B:{query:"",era:"",archetype:""}},P=[],N=new Map,O=!i,M=S=>{let A=v[S];if(!A.pool)return;let k=new Set;j(w.A).forEach(I=>k.add(I.id)),j(w.B).forEach(I=>k.add(I.id));let L=Ku(P,k,E[S]).slice().sort((I,$)=>I.name.localeCompare($.name));if(A.pool.replaceChildren(),!L.length){let I=document.createElement("p");I.className="rumble-empty",I.textContent="No players match the filters.",A.pool.append(I);return}let z=E[S].query?50:30;L.slice(0,z).forEach(I=>{var tt;let $=ju(I);$.addEventListener("click",()=>{let pt=Qu(w[S]);pt!==null&&(w[S].slots[pt]=I,_(S),D(),G())}),(tt=A.pool)==null||tt.append($)})},_=S=>{let A=v[S],k=w[S];if(A.slots&&(A.slots.replaceChildren(),k.slots.forEach((T,L)=>{var $;let z=Ju(T,L),I=z.querySelector("[data-remove]");I&&I.addEventListener("click",()=>{k.slots[L]=null,_(S),D(),G()}),($=A.slots)==null||$.append(z)})),A.graph){let T=j(k),L=Rt(T,b);T.length?Yi(A.graph,T,L.edges,{title:k.name}):A.graph.textContent="Add players to visualize chemistry."}M("A"),M("B")},B=S=>{var z;let A=Object.keys(n);if(!A.length)return;let k=(z=A[S==="A"?0:1])!=null?z:A[0],T=n[k];if(!Array.isArray(T))return;w[S].slots=new Array(Q).fill(null);let L=0;T.forEach(I=>{if(L>=Q)return;let $=N.get(I);$&&(w[S].slots[L]=$,L+=1)}),_(S),D(),G()},C=()=>{let S=w.A.slots;w.A.slots=w.B.slots,w.B.slots=S,_("A"),_("B"),D(),G()},D=()=>{let S=a.querySelector(".rumble-shell__footer"),A=j(w.A).length===Q&&j(w.B).length===Q;S&&(S.textContent=A?"Ready to simulate.":"Pick five for each side to unlock the sim."),c.disabled=!A},et=()=>{let S=j(w.A),A=j(w.B),k=Rt(S,b),T=Rt(A,b),L=Je(S,A,b),z=[...k.reasons.slice(0,3),...L.reasonsA.slice(0,2)],I=[...T.reasons.slice(0,3),...L.reasonsB.slice(0,2)];if(d.replaceChildren(),y.replaceChildren(),z.length)z.forEach(tt=>{let pt=document.createElement("li");pt.textContent=tt,d.append(pt)});else{let tt=document.createElement("li");tt.textContent="Build a lineup to surface strengths.",d.append(tt)}if(I.length)I.forEach(tt=>{let pt=document.createElement("li");pt.textContent=tt,y.append(pt)});else{let tt=document.createElement("li");tt.textContent="Add opponents to reveal weaknesses.",y.append(tt)}let $=(()=>{switch(b){case"nineties":return"Post-ups and POA defense boosted; 3s devalued.";case"pre3":return"No 3s; spacing bonuses reduced; interior play rewarded.";case"oldschool":return"Few possessions; size, ORB, and defense prioritized.";default:return""}})();$?(x.textContent=$,x.hidden=!1):(x.textContent="",x.hidden=!0)},G=()=>{let S={a:j(w.A).map(A=>A.id),b:j(w.B).map(A=>A.id),style:b};tn(S)},Z=()=>{let S=j(w.A),A=j(w.B);if(S.length!==Q||A.length!==Q)return;let k=Zi(S,A,{games:100,eraStyle:b}),T=a.querySelector("[data-kpi='a']"),L=a.querySelector("[data-kpi='b']"),z=a.querySelector("[data-kpi='margin']");T&&L&&z&&(T.textContent=ji(k.teamAWins/k.margins.length*100),L.textContent=ji(k.teamBWins/k.margins.length*100),z.textContent=`${(k.avgScoreA-k.avgScoreB).toFixed(1)} pts`),tl(p,k.margins),et()},J=S=>{S&&(w.A.slots=new Array(Q).fill(null),w.B.slots=new Array(Q).fill(null),S.a.forEach((A,k)=>{if(k<Q){let T=N.get(A);T&&(w.A.slots[k]=T)}}),S.b.forEach((A,k)=>{if(k<Q){let T=N.get(A);T&&(w.B.slots[k]=T)}}),dt(S.style)?b=S.style:b="current",g.value=b,_("A"),_("B"),D(),j(w.A).length===Q&&j(w.B).length===Q?Z():et())};i&&f.addEventListener("click",()=>{a.classList.remove("is-open")}),c.addEventListener("click",Z),g.addEventListener("change",()=>{let S=g.value;dt(S)?b=S:b="current",_("A"),_("B"),et(),Z(),G()}),a.addEventListener("click",S=>{let A=S.target;if(A.dataset.action==="swap"&&C(),A.dataset.action==="clear"&&A.dataset.team){let k=A.dataset.team;w[k].slots=new Array(Q).fill(null),_(k),D(),G()}A.dataset.action==="preset"&&A.dataset.team&&B(A.dataset.team)}),["A","B"].forEach(S=>{var T,L,z;let A=S,k=v[A];(T=k.search)==null||T.addEventListener("input",()=>{var I,$;E[A].query=Tt(($=(I=k.search)==null?void 0:I.value)!=null?$:""),M(A)}),(L=k.era)==null||L.addEventListener("change",()=>{var I,$;E[A].era=Tt(($=(I=k.era)==null?void 0:I.value)!=null?$:""),M(A)}),(z=k.archetype)==null||z.addEventListener("change",()=>{var I,$;E[A].archetype=Tt(($=(I=k.archetype)==null?void 0:I.value)!=null?$:""),M(A)})}),P=await r(),N=new Map(P.map(S=>[S.id,S]));let Y=Qi(P.map(S=>S.era).filter(Boolean)),he=Qi(P.flatMap(S=>S.archetypes));["A","B"].forEach(S=>{let k=v[S];Y.forEach(T=>{var z;let L=document.createElement("option");L.value=T,L.textContent=T,(z=k.era)==null||z.append(L)}),he.forEach(T=>{var z;let L=document.createElement("option");L.value=T,L.textContent=T,(z=k.archetype)==null||z.append(L)})}),M("A"),M("B"),_("A"),_("B"),D(),et();let pe={open(S){O||(a.classList.add("is-ready"),O=!0),i&&a.classList.add("is-open"),S&&J(S)},close(){i&&a.classList.remove("is-open")},isOpen(){return i?a.classList.contains("is-open"):!0}},Ht=ye(window.location.hash.startsWith("#rumble=")?window.location.hash.slice(8):null);return Ht&&J(Ht),pe}function _t(t){let e=2166136261;for(let r=0;r<t.length;r+=1)e^=t.charCodeAt(r),e+=(e<<1)+(e<<4)+(e<<7)+(e<<8)+(e<<24),e>>>=0;return e>>>0}function St(t,e,r){let n=t/4294967295;return e+(r-e)*n}function el(t){if(!t)return[];let e=t.toLowerCase(),r=[];return e.includes("creator")&&r.push("Creator"),e.includes("shooter")&&r.push("Off-ball Shooter"),e.includes("rim")&&r.push("Rim Runner"),e.includes("switch")&&r.push("Switch Big"),e.includes("protector")&&r.push("Rim Protector"),(e.includes("connector")||e.includes("glue"))&&r.push("Connector"),e.includes("secondary")&&r.push("Secondary"),e.includes("stopper")&&r.push("POA Stopper"),e.includes("stretch")&&r.push("Stretch Big"),r}var rl=["games","minutes","points","rebounds","assists","steals","blocks","turnovers","fouls","fgm","fga","fg3m","fg3a","ftm","fta","oreb","dreb"];function er(t){return t?t.toLowerCase().replace(/[^a-z0-9]+/g," ").trim().replace(/\s+/g," "):null}function nl(t){let e=new Map,r=new Map,n=new Map;return t!=null&&t.players&&typeof t.players=="object"&&Object.entries(t.players).forEach(([o,i])=>{e.set(String(o),i!=null?i:{})}),t!=null&&t.byName&&typeof t.byName=="object"&&Object.entries(t.byName).forEach(([o,i])=>{let a=er(o);a&&r.set(a,i!=null?i:{})}),{careerById:e,careerByName:r,nameToCareerId:n}}function ol(t,e){if(!t&&!e)return null;let r={};return rl.forEach(n=>{var a,s;let o=(a=t==null?void 0:t[n])!=null?a:0,i=(s=e==null?void 0:e[n])!=null?s:0;r[n]=o+i}),r}function il(t){let e=new Set;return[t==null?void 0:t.regular,t==null?void 0:t.postseason].forEach(n=>{n!=null&&n.seasons&&n.seasons.forEach(o=>{Number.isFinite(o)&&e.add(Number(o))})}),Array.from(e.values()).sort((n,o)=>n-o)}function al(t){if(!t.length)return null;let e=t[0],r=t[t.length-1],n=Math.floor(e/10)*10,o=Math.floor(r/10)*10;return n===o?`${n}s`:`${n}s\u2013${o}s`}function sl(t){if(!t.length)return 0;let r=(t.reduce((n,o)=>n+o,0)/t.length-2e3)/25;return r>1?1:r<-1?-1:r}function tr(t,e){return!Number.isFinite(t)||!Number.isFinite(e)||e===0?0:t/e}function ul(t){return t?tr(t.minutes,60):0}function ll(t,e){if(!t||e<=0)return 0;let r=t.fga+.44*t.fta+t.turnovers;if(r<=0)return 0;let n=e/48*100;if(n<=0)return 0;let o=r/n;return Math.max(0,Math.min(60,o*100))}function fl(t){if(!t)return 0;let e=t.fga+.44*t.fta+t.turnovers+t.assists;if(e<=0)return 0;let r=t.assists/e;return Math.max(0,Math.min(60,r*100))}function cl(t,e,r,n,o){if(!t||e<=0)return o&&Number.isFinite(o)?Math.max(2,o/3.5):4;let i=t.points/e*36,a=t.rebounds/e*36,s=t.assists/e*36,l=(t.steals+t.blocks)/e*36,u=tr(t.fg3m,t.fg3a),m=i*.28+a*.18+s*.25+l*.35,h=(u-.34)*35,f=Math.max(0,n-18)*.25,c=Math.max(0,r-22)*.3,g=m/4+h+f+c;return o&&Number.isFinite(o)&&(g=Math.max(g,o/3.2)),g<2?2:g>13?13:g}function ml(t,e){var o,i;let r=new Set;((o=t.bdl)==null?void 0:o.id)!==null&&((i=t.bdl)==null?void 0:i.id)!==void 0&&r.add(String(t.bdl.id)),t.personId!==null&&t.personId!==void 0&&r.add(String(t.personId)),t.id!==null&&t.id!==void 0&&r.add(String(t.id));let n=er(t.name);if(n){let a=e.nameToCareerId.get(n);a&&r.add(a)}for(let a of r){let s=e.careerById.get(a);if(s)return{id:a,record:s}}if(n){let a=e.careerByName.get(n);if(a)return{id:n,record:a}}return null}function hl(t,e){var v,w,E,P,N,O,M,_,B,C,D,et,G,Z,J,Y,he,pe,Ht,S;let r=String((w=(v=t.personId)!=null?v:t.id)!=null?w:t.name),n=ml(t,e),o=(E=n==null?void 0:n.id)!=null?E:r,i=t.name||o,a=`${o}:${i}`,s=_t(a),l=ol((O=(N=(P=n==null?void 0:n.record)==null?void 0:P.regular)==null?void 0:N.totals)!=null?O:null,(B=(_=(M=n==null?void 0:n.record)==null?void 0:M.postseason)==null?void 0:_.totals)!=null?B:null),u=ul(l),m=ll(l,u),h=fl(l),f=tr((C=l==null?void 0:l.fg3m)!=null?C:0,(D=l==null?void 0:l.fg3a)!=null?D:0),c=tr((et=l==null?void 0:l.fg3a)!=null?et:0,(G=l==null?void 0:l.fga)!=null?G:0),g=u>0?((Z=l==null?void 0:l.steals)!=null?Z:0)/u:0,p=u>0?((J=l==null?void 0:l.blocks)!=null?J:0)/u:0,d=il(n==null?void 0:n.record),y=sl(d),x=cl(l,u,m,h,t.goatImpact),b={id:o,name:i,era:(he=(Y=t.era)!=null?Y:al(d))!=null?he:null,pos:(pe=t.position)!=null?pe:null,franchise:(S=(Ht=t.teamAbbr)!=null?Ht:t.team)!=null?S:null,threeP:Number.isFinite(f)&&f>=0?f:St(_t(`${a}:3P`),.26,.45),threePA_rate:Number.isFinite(c)&&c>=0?c:St(_t(`${a}:3PA`),.18,.65),astPct:Number.isFinite(h)&&h>=0?h:St(_t(`${a}:AST`),10,38),usg:Number.isFinite(m)&&m>0?m:St(_t(`${a}:USG`),18,32),stl:Number.isFinite(g)&&g>=0?Math.min(.12,Math.max(0,g)):St(_t(`${a}:STL`),.01,.045),blk:Number.isFinite(p)&&p>=0?Math.min(.12,Math.max(0,p)):St(_t(`${a}:BLK`),.005,.045),paceZ:Number.isFinite(y)?y:St(_t(`${a}:PACE`),-1,1),impact:Number.isFinite(x)?x:St(s,3,11),archetypes:el(t.archetype).map(A=>A)};return b.archetypes.length||(b.archetypes=ge(b)),b}function pl(t){if(!t)return null;let e=t.match(/\d{4}/g);if(!e||!e.length)return null;let r=Number.parseInt(e[0],10),n=Number.parseInt(e[e.length-1],10);if(!Number.isFinite(r))return null;let o=Math.floor(r/10)*10,i=Number.isFinite(n)?Math.floor(n/10)*10:o;return o===i?`${o}s`:`${o}s\u2013${i}s`}function dl(t){if(t.personId!==void 0&&t.personId!==null)return String(t.personId);if(t.id!==void 0&&t.id!==null)return String(t.id);let e=er(t.name);return e!=null?e:t.name.toLowerCase()}function gl(t){var r,n,o,i,a,s,l;if(!t||!t.name)return null;let e=Array.isArray(t.franchises)?t.franchises:[];return{id:(r=t.personId)!=null?r:t.name,personId:t.personId,name:t.name,era:pl((o=(n=t.primeWindow)!=null?n:t.careerSpan)!=null?o:null),team:e.length&&(i=e[0])!=null?i:null,teamAbbr:e.length&&(a=e[0])!=null?a:null,position:null,archetype:null,goatImpact:(l=(s=t.goatComponents)==null?void 0:s.impact)!=null?l:null}}async function xl(){let[t,e,r,n]=await Promise.all([fetch(new URL("data/player_profiles.json",document.baseURI)),fetch(new URL("data/goat_system.json",document.baseURI)).catch(()=>null),fetch(new URL("data/history/player_careers.json",document.baseURI)).catch(()=>null),fetch(new URL("data/history/players.index.json",document.baseURI)).catch(()=>null)]);if(!t.ok)throw new Error(`Failed to load player profiles: ${t.status}`);let[o,i,a]=await Promise.all([t.json(),r&&r.ok?r.json():Promise.resolve(null),n&&n.ok?n.json():Promise.resolve(null)]),s=(()=>{let f=nl(i),c=a;return Array.isArray(c==null?void 0:c.players)&&c.players.forEach(g=>{var d,y,x;let p=er((x=g.full_name)!=null?x:`${(d=g.first_name)!=null?d:""} ${(y=g.last_name)!=null?y:""}`);p&&g.id!==null&&g.id!==void 0&&f.nameToCareerId.set(p,String(g.id))}),f})(),l=new Map,u=f=>{var g,p;if(!f||!f.name)return;let c=dl(f);if(l.has(c)){let d=l.get(c);(!d.era||d.era==="")&&f.era&&(d.era=f.era),(!d.team||d.team==="")&&f.team&&(d.team=f.team),(!d.teamAbbr||d.teamAbbr==="")&&f.teamAbbr&&(d.teamAbbr=f.teamAbbr),(!d.position||d.position==="")&&f.position&&(d.position=f.position),(!d.archetype||d.archetype==="")&&f.archetype&&(d.archetype=f.archetype),(!d.bdl||!d.bdl.id)&&((g=f.bdl)!=null&&g.id)&&(d.bdl={...(p=d.bdl)!=null?p:{},id:f.bdl.id}),(d.goatImpact===null||d.goatImpact===void 0)&&f.goatImpact!==null&&f.goatImpact!==void 0&&(d.goatImpact=f.goatImpact);return}l.set(c,{...f})};if((Array.isArray(o==null?void 0:o.players)?o.players:[]).forEach(f=>u(f)),e&&e.ok)try{let f=await e.json();(Array.isArray(f==null?void 0:f.players)?f.players:[]).forEach(g=>{let p=gl(g);p&&u(p)})}catch(f){console.warn("Unable to load GOAT system player pool",f)}let h=Array.from(l.values()).map(f=>hl(f,s));return h.sort((f,c)=>f.name.localeCompare(c.name)),h}var yl={"96Bulls":["michael-jordan","scottie-pippen","dennis-rodman","ron-harper","steve-kerr"],"17Warriors":["stephen-curry","kevin-durant","klay-thompson","draymond-green","andre-iguodala"]};async function ky({trigger:t,root:e,mode:r="overlay"}){let n=Jr(),o=await ta({root:e,getPlayerPool:xl,presets:yl,mode:r});return n&&o.open(n),t&&t.addEventListener("click",()=>{o.open()}),o}export{ye as decodeMatchup,ky as mountRosterRumble,Jr as readHash};
